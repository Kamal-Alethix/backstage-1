{"version":3,"file":"index.cjs.js","sources":["../src/actions/fetch/rails/railsArgumentResolver.ts","../src/actions/fetch/rails/railsNewRunner.ts","../src/actions/fetch/rails/index.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { sep as separatorPath } from 'path';\n\nenum Webpacker {\n  react = 'react',\n  vue = 'vue',\n  angular = 'angular',\n  elm = 'elm',\n  stimulus = 'stimulus',\n}\n\nenum Database {\n  mysql = 'mysql',\n  postgresql = 'postgresql',\n  sqlite3 = 'sqlite3',\n  oracle = 'oracle',\n  sqlserver = 'sqlserver',\n  jdbcmysql = 'jdbcmysql',\n  jdbcsqlite3 = 'jdbcsqlite3',\n  jdbcpostgresql = 'jdbcpostgresql',\n  jdbc = 'jdbc',\n}\n\nenum RailsVersion {\n  dev = 'dev',\n  edge = 'edge',\n  master = 'master',\n  fromImage = 'fromImage',\n}\n\nexport type RailsRunOptions = {\n  minimal?: boolean;\n  api?: boolean;\n  template?: string;\n  webpacker?: Webpacker;\n  database?: Database;\n  railsVersion?: RailsVersion;\n  skipBundle?: boolean;\n  skipWebpackInstall?: boolean;\n  skipTest?: boolean;\n  force?: boolean;\n};\n\nexport const railsArgumentResolver = (\n  projectRoot: string,\n  options: RailsRunOptions,\n  executionOnContainer = false,\n): string[] => {\n  const argumentsToRun: string[] = [];\n\n  if (options?.minimal) {\n    argumentsToRun.push('--minimal');\n  }\n\n  if (options?.api) {\n    argumentsToRun.push('--api');\n  }\n\n  if (options?.skipBundle) {\n    argumentsToRun.push('--skip-bundle');\n  }\n\n  if (options?.skipWebpackInstall) {\n    argumentsToRun.push('--skip-webpack-install');\n  }\n\n  if (options?.skipTest) {\n    argumentsToRun.push('--skip-test');\n  }\n\n  if (options?.force) {\n    argumentsToRun.push('--force');\n  }\n\n  if (\n    options?.webpacker &&\n    Object.values(Webpacker).includes(options?.webpacker as Webpacker)\n  ) {\n    argumentsToRun.push('--webpack');\n    argumentsToRun.push(options.webpacker);\n  }\n\n  if (\n    options?.database &&\n    Object.values(Database).includes(options?.database as Database)\n  ) {\n    argumentsToRun.push('--database');\n    argumentsToRun.push(options.database);\n  }\n\n  if (\n    options?.railsVersion !== RailsVersion.fromImage &&\n    Object.values(RailsVersion).includes(options?.railsVersion as RailsVersion)\n  ) {\n    argumentsToRun.push(`--${options.railsVersion}`);\n  }\n\n  if (options?.template) {\n    argumentsToRun.push('--template');\n    argumentsToRun.push(\n      options.template.replace(\n        `.${separatorPath}`,\n        `${projectRoot}${executionOnContainer ? '/' : separatorPath}`,\n      ),\n    );\n  }\n\n  return argumentsToRun;\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContainerRunner } from '@backstage/backend-common';\nimport fs from 'fs-extra';\nimport path from 'path';\nimport { executeShellCommand } from '@backstage/plugin-scaffolder-backend';\nimport commandExists from 'command-exists';\nimport {\n  railsArgumentResolver,\n  RailsRunOptions,\n} from './railsArgumentResolver';\nimport { JsonObject } from '@backstage/types';\nimport { Writable } from 'stream';\n\nexport class RailsNewRunner {\n  private readonly containerRunner: ContainerRunner;\n\n  constructor({ containerRunner }: { containerRunner: ContainerRunner }) {\n    this.containerRunner = containerRunner;\n  }\n\n  public async run({\n    workspacePath,\n    values,\n    logStream,\n  }: {\n    workspacePath: string;\n    values: JsonObject;\n    logStream: Writable;\n  }): Promise<void> {\n    const intermediateDir = path.join(workspacePath, 'intermediate');\n    await fs.ensureDir(intermediateDir);\n    const resultDir = path.join(workspacePath, 'result');\n\n    const { name, imageName, railsArguments } = values;\n\n    // Directories to bind on container\n    const mountDirs = {\n      [workspacePath]: '/input',\n      [intermediateDir]: '/output',\n    };\n\n    const baseCommand = 'rails';\n    const baseArguments = ['new'];\n    const commandExistsToRun = await commandExists(baseCommand);\n\n    if (commandExistsToRun) {\n      const arrayExtraArguments = railsArgumentResolver(\n        workspacePath,\n        railsArguments as RailsRunOptions,\n      );\n\n      await executeShellCommand({\n        command: baseCommand,\n        args: [\n          ...baseArguments,\n          `${intermediateDir}${path.sep}${name}`,\n          ...arrayExtraArguments,\n        ],\n        logStream,\n      });\n    } else {\n      if (!imageName) {\n        throw new Error('No imageName provided');\n      }\n      const arrayExtraArguments = railsArgumentResolver(\n        '/input',\n        railsArguments as RailsRunOptions,\n        true,\n      );\n      await this.containerRunner.runContainer({\n        imageName: imageName as string,\n        command: baseCommand,\n        args: [...baseArguments, `/output/${name}`, ...arrayExtraArguments],\n        mountDirs,\n        workingDir: '/input',\n        // Set the home directory inside the container as something that applications can\n        // write to, otherwise they will just fail trying to write to /\n        envVars: { HOME: '/tmp' },\n        logStream,\n      });\n    }\n\n    // if command was successful, intermediateDir should contain\n    // exactly one directory.\n    const [generated] = await fs.readdir(intermediateDir);\n\n    if (generated === undefined) {\n      throw new Error(`No data generated by ${baseCommand}`);\n    }\n\n    await fs.move(path.join(intermediateDir, generated), resultDir);\n  }\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContainerRunner, UrlReader } from '@backstage/backend-common';\nimport { JsonObject } from '@backstage/types';\nimport { InputError } from '@backstage/errors';\nimport { ScmIntegrations } from '@backstage/integration';\nimport fs from 'fs-extra';\nimport {\n  createTemplateAction,\n  fetchContents,\n} from '@backstage/plugin-scaffolder-backend';\n\nimport { resolve as resolvePath } from 'path';\nimport { RailsNewRunner } from './railsNewRunner';\n\n/**\n * Creates the `fetch:rails` Scaffolder action.\n *\n * @remarks\n *\n * See {@link https://guides.rubyonrails.org/rails_application_templates.html} and {@link https://backstage.io/docs/features/software-templates/writing-custom-actions}.\n *\n * @param options - Configuration of the templater.\n * @public\n */\nexport function createFetchRailsAction(options: {\n  reader: UrlReader;\n  integrations: ScmIntegrations;\n  containerRunner: ContainerRunner;\n  /** A list of image names that are allowed to be passed as imageName input */\n  allowedImageNames?: string[];\n}) {\n  const { reader, integrations, containerRunner } = options;\n\n  return createTemplateAction<{\n    url: string;\n    targetPath?: string;\n    values: JsonObject;\n    imageName?: string;\n  }>({\n    id: 'fetch:rails',\n    description:\n      'Downloads a template from the given URL into the workspace, and runs a rails new generator on it.',\n    schema: {\n      input: {\n        type: 'object',\n        required: ['url'],\n        properties: {\n          url: {\n            title: 'Fetch URL',\n            description:\n              'Relative path or absolute URL pointing to the directory tree to fetch',\n            type: 'string',\n          },\n          targetPath: {\n            title: 'Target Path',\n            description:\n              'Target path within the working directory to download the contents to.',\n            type: 'string',\n          },\n          values: {\n            title: 'Template Values',\n            description: 'Values to pass on to rails for templating',\n            type: 'object',\n            properties: {\n              railsArguments: {\n                title: 'Arguments to pass to new command',\n                description:\n                  'You can provide some arguments to create a custom app',\n                type: 'object',\n                properties: {\n                  minimal: {\n                    title: 'minimal',\n                    description: 'Preconfigure a minimal rails app',\n                    type: 'boolean',\n                  },\n                  skipBundle: {\n                    title: 'skipBundle',\n                    description: \"Don't run bundle install\",\n                    type: 'boolean',\n                  },\n                  skipWebpackInstall: {\n                    title: 'skipWebpackInstall',\n                    description: \"Don't run Webpack install\",\n                    type: 'boolean',\n                  },\n                  skipTest: {\n                    title: 'skipTest',\n                    description: 'Skip test files',\n                    type: 'boolean',\n                  },\n                  force: {\n                    title: 'force',\n                    description: 'Overwrite files that already exist',\n                    type: 'boolean',\n                  },\n                  api: {\n                    title: 'api',\n                    description: 'Preconfigure smaller stack for API only apps',\n                    type: 'boolean',\n                  },\n                  template: {\n                    title: 'template',\n                    description:\n                      'Path to some application template (can be a filesystem path or URL)',\n                    type: 'string',\n                  },\n                  webpacker: {\n                    title: 'webpacker',\n                    description:\n                      'Preconfigure Webpack with a particular framework (options: react, vue, angular, elm, stimulus)',\n                    type: 'string',\n                    enum: ['react', 'vue', 'angular', 'elm', 'stimulus'],\n                  },\n                  database: {\n                    title: 'database',\n                    description:\n                      'Preconfigure for selected database (options: mysql/postgresql/sqlite3/oracle/sqlserver/jdbcmysql/jdbcsqlite3/jdbcpostgresql/jdbc)',\n                    type: 'string',\n                    enum: [\n                      'mysql',\n                      'postgresql',\n                      'sqlite3',\n                      'oracle',\n                      'sqlserver',\n                      'jdbcmysql',\n                      'jdbcsqlite3',\n                      'jdbcpostgresql',\n                      'jdbc',\n                    ],\n                  },\n                  railsVersion: {\n                    title: 'Rails version in Gemfile',\n                    description:\n                      'Set up the application with Gemfile pointing to a specific version (options: fromImage, dev, edge, master)',\n                    type: 'string',\n                    enum: ['dev', 'edge', 'master', 'fromImage'],\n                  },\n                },\n              },\n            },\n          },\n          imageName: {\n            title: 'Rails Docker image',\n            description:\n              'Specify a Docker image to run rails new. Used only when a local rails is not found.',\n            type: 'string',\n          },\n        },\n      },\n    },\n    async handler(ctx) {\n      ctx.logger.info('Fetching and then templating using rails');\n\n      const workDir = await ctx.createTemporaryDirectory();\n      const resultDir = resolvePath(workDir, 'result');\n\n      await fetchContents({\n        reader,\n        integrations,\n        baseUrl: ctx.templateInfo?.baseUrl,\n        fetchUrl: ctx.input.url,\n        outputPath: workDir,\n      });\n\n      const templateRunner = new RailsNewRunner({ containerRunner });\n\n      const { imageName } = ctx.input;\n      if (imageName && !options.allowedImageNames?.includes(imageName)) {\n        throw new Error(`Image ${imageName} is not allowed`);\n      }\n\n      // Will execute the template in ./template and put the result in ./result\n      await templateRunner.run({\n        workspacePath: workDir,\n        logStream: ctx.logStream,\n        values: { ...ctx.input.values, imageName },\n      });\n\n      // Finally move the template result into the task workspace\n      const targetPath = ctx.input.targetPath ?? './';\n      const outputPath = resolvePath(ctx.workspacePath, targetPath);\n      if (!outputPath.startsWith(ctx.workspacePath)) {\n        throw new InputError(\n          `Fetch action targetPath may not specify a path outside the working directory`,\n        );\n      }\n      await fs.copy(resultDir, outputPath);\n    },\n  });\n}\n"],"names":["separatorPath","path","fs","commandExists","executeShellCommand","createTemplateAction","resolvePath","fetchContents","InputError"],"mappings":";;;;;;;;;;;;;;;;AACA,IAAI,SAAS,mBAAmB,CAAC,CAAC,UAAU,KAAK;AACjD,EAAE,UAAU,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;AAChC,EAAE,UAAU,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;AAC5B,EAAE,UAAU,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;AACpC,EAAE,UAAU,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;AAC5B,EAAE,UAAU,CAAC,UAAU,CAAC,GAAG,UAAU,CAAC;AACtC,EAAE,OAAO,UAAU,CAAC;AACpB,CAAC,EAAE,SAAS,IAAI,EAAE,CAAC,CAAC;AACpB,IAAI,QAAQ,mBAAmB,CAAC,CAAC,SAAS,KAAK;AAC/C,EAAE,SAAS,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;AAC/B,EAAE,SAAS,CAAC,YAAY,CAAC,GAAG,YAAY,CAAC;AACzC,EAAE,SAAS,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;AACnC,EAAE,SAAS,CAAC,QAAQ,CAAC,GAAG,QAAQ,CAAC;AACjC,EAAE,SAAS,CAAC,WAAW,CAAC,GAAG,WAAW,CAAC;AACvC,EAAE,SAAS,CAAC,WAAW,CAAC,GAAG,WAAW,CAAC;AACvC,EAAE,SAAS,CAAC,aAAa,CAAC,GAAG,aAAa,CAAC;AAC3C,EAAE,SAAS,CAAC,gBAAgB,CAAC,GAAG,gBAAgB,CAAC;AACjD,EAAE,SAAS,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;AAC7B,EAAE,OAAO,SAAS,CAAC;AACnB,CAAC,EAAE,QAAQ,IAAI,EAAE,CAAC,CAAC;AACnB,IAAI,YAAY,mBAAmB,CAAC,CAAC,aAAa,KAAK;AACvD,EAAE,aAAa,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;AAC/B,EAAE,aAAa,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;AACjC,EAAE,aAAa,CAAC,QAAQ,CAAC,GAAG,QAAQ,CAAC;AACrC,EAAE,aAAa,CAAC,WAAW,CAAC,GAAG,WAAW,CAAC;AAC3C,EAAE,OAAO,aAAa,CAAC;AACvB,CAAC,EAAE,YAAY,IAAI,EAAE,CAAC,CAAC;AAChB,MAAM,qBAAqB,GAAG,CAAC,WAAW,EAAE,OAAO,EAAE,oBAAoB,GAAG,KAAK,KAAK;AAC7F,EAAE,MAAM,cAAc,GAAG,EAAE,CAAC;AAC5B,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,OAAO,EAAE;AAClD,IAAI,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AACrC,GAAG;AACH,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,GAAG,EAAE;AAC9C,IAAI,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACjC,GAAG;AACH,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,UAAU,EAAE;AACrD,IAAI,cAAc,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;AACzC,GAAG;AACH,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,kBAAkB,EAAE;AAC7D,IAAI,cAAc,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;AAClD,GAAG;AACH,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,QAAQ,EAAE;AACnD,IAAI,cAAc,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;AACvC,GAAG;AACH,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,KAAK,EAAE;AAChD,IAAI,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;AACnC,GAAG;AACH,EAAE,IAAI,CAAC,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,SAAS,KAAK,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,SAAS,CAAC,EAAE;AACzI,IAAI,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AACrC,IAAI,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AAC3C,GAAG;AACH,EAAE,IAAI,CAAC,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,QAAQ,KAAK,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,EAAE;AACtI,IAAI,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AACtC,IAAI,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC1C,GAAG;AACH,EAAE,IAAI,CAAC,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,YAAY,MAAM,WAAW,oBAAoB,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,EAAE;AAClL,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;AACrD,GAAG;AACH,EAAE,IAAI,OAAO,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,OAAO,CAAC,QAAQ,EAAE;AACnD,IAAI,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;AACtC,IAAI,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EAAEA,QAAa,CAAC,CAAC,EAAE,CAAC,EAAE,WAAW,CAAC,EAAE,oBAAoB,GAAG,GAAG,GAAGA,QAAa,CAAC,CAAC,CAAC,CAAC,CAAC;AACtI,GAAG;AACH,EAAE,OAAO,cAAc,CAAC;AACxB,CAAC;;ACzDM,MAAM,cAAc,CAAC;AAC5B,EAAE,WAAW,CAAC,EAAE,eAAe,EAAE,EAAE;AACnC,IAAI,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;AAC3C,GAAG;AACH,EAAE,MAAM,GAAG,CAAC;AACZ,IAAI,aAAa;AACjB,IAAI,MAAM;AACV,IAAI,SAAS;AACb,GAAG,EAAE;AACL,IAAI,MAAM,eAAe,GAAGC,wBAAI,CAAC,IAAI,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;AACrE,IAAI,MAAMC,sBAAE,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;AACxC,IAAI,MAAM,SAAS,GAAGD,wBAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;AACzD,IAAI,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,cAAc,EAAE,GAAG,MAAM,CAAC;AACvD,IAAI,MAAM,SAAS,GAAG;AACtB,MAAM,CAAC,aAAa,GAAG,QAAQ;AAC/B,MAAM,CAAC,eAAe,GAAG,SAAS;AAClC,KAAK,CAAC;AACN,IAAI,MAAM,WAAW,GAAG,OAAO,CAAC;AAChC,IAAI,MAAM,aAAa,GAAG,CAAC,KAAK,CAAC,CAAC;AAClC,IAAI,MAAM,kBAAkB,GAAG,MAAME,iCAAa,CAAC,WAAW,CAAC,CAAC;AAChE,IAAI,IAAI,kBAAkB,EAAE;AAC5B,MAAM,MAAM,mBAAmB,GAAG,qBAAqB,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;AACvF,MAAM,MAAMC,2CAAmB,CAAC;AAChC,QAAQ,OAAO,EAAE,WAAW;AAC5B,QAAQ,IAAI,EAAE;AACd,UAAU,GAAG,aAAa;AAC1B,UAAU,CAAC,EAAE,eAAe,CAAC,EAAEH,wBAAI,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;AAChD,UAAU,GAAG,mBAAmB;AAChC,SAAS;AACT,QAAQ,SAAS;AACjB,OAAO,CAAC,CAAC;AACT,KAAK,MAAM;AACX,MAAM,IAAI,CAAC,SAAS,EAAE;AACtB,QAAQ,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;AACjD,OAAO;AACP,MAAM,MAAM,mBAAmB,GAAG,qBAAqB,CAAC,QAAQ,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;AACxF,MAAM,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC;AAC9C,QAAQ,SAAS;AACjB,QAAQ,OAAO,EAAE,WAAW;AAC5B,QAAQ,IAAI,EAAE,CAAC,GAAG,aAAa,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,EAAE,GAAG,mBAAmB,CAAC;AAC3E,QAAQ,SAAS;AACjB,QAAQ,UAAU,EAAE,QAAQ;AAC5B,QAAQ,OAAO,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE;AACjC,QAAQ,SAAS;AACjB,OAAO,CAAC,CAAC;AACT,KAAK;AACL,IAAI,MAAM,CAAC,SAAS,CAAC,GAAG,MAAMC,sBAAE,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;AAC1D,IAAI,IAAI,SAAS,KAAK,KAAK,CAAC,EAAE;AAC9B,MAAM,MAAM,IAAI,KAAK,CAAC,CAAC,qBAAqB,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC;AAC7D,KAAK;AACL,IAAI,MAAMA,sBAAE,CAAC,IAAI,CAACD,wBAAI,CAAC,IAAI,CAAC,eAAe,EAAE,SAAS,CAAC,EAAE,SAAS,CAAC,CAAC;AACpE,GAAG;AACH;;ACnDO,SAAS,sBAAsB,CAAC,OAAO,EAAE;AAChD,EAAE,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,eAAe,EAAE,GAAG,OAAO,CAAC;AAC5D,EAAE,OAAOI,4CAAoB,CAAC;AAC9B,IAAI,EAAE,EAAE,aAAa;AACrB,IAAI,WAAW,EAAE,mGAAmG;AACpH,IAAI,MAAM,EAAE;AACZ,MAAM,KAAK,EAAE;AACb,QAAQ,IAAI,EAAE,QAAQ;AACtB,QAAQ,QAAQ,EAAE,CAAC,KAAK,CAAC;AACzB,QAAQ,UAAU,EAAE;AACpB,UAAU,GAAG,EAAE;AACf,YAAY,KAAK,EAAE,WAAW;AAC9B,YAAY,WAAW,EAAE,uEAAuE;AAChG,YAAY,IAAI,EAAE,QAAQ;AAC1B,WAAW;AACX,UAAU,UAAU,EAAE;AACtB,YAAY,KAAK,EAAE,aAAa;AAChC,YAAY,WAAW,EAAE,uEAAuE;AAChG,YAAY,IAAI,EAAE,QAAQ;AAC1B,WAAW;AACX,UAAU,MAAM,EAAE;AAClB,YAAY,KAAK,EAAE,iBAAiB;AACpC,YAAY,WAAW,EAAE,2CAA2C;AACpE,YAAY,IAAI,EAAE,QAAQ;AAC1B,YAAY,UAAU,EAAE;AACxB,cAAc,cAAc,EAAE;AAC9B,gBAAgB,KAAK,EAAE,kCAAkC;AACzD,gBAAgB,WAAW,EAAE,uDAAuD;AACpF,gBAAgB,IAAI,EAAE,QAAQ;AAC9B,gBAAgB,UAAU,EAAE;AAC5B,kBAAkB,OAAO,EAAE;AAC3B,oBAAoB,KAAK,EAAE,SAAS;AACpC,oBAAoB,WAAW,EAAE,kCAAkC;AACnE,oBAAoB,IAAI,EAAE,SAAS;AACnC,mBAAmB;AACnB,kBAAkB,UAAU,EAAE;AAC9B,oBAAoB,KAAK,EAAE,YAAY;AACvC,oBAAoB,WAAW,EAAE,0BAA0B;AAC3D,oBAAoB,IAAI,EAAE,SAAS;AACnC,mBAAmB;AACnB,kBAAkB,kBAAkB,EAAE;AACtC,oBAAoB,KAAK,EAAE,oBAAoB;AAC/C,oBAAoB,WAAW,EAAE,2BAA2B;AAC5D,oBAAoB,IAAI,EAAE,SAAS;AACnC,mBAAmB;AACnB,kBAAkB,QAAQ,EAAE;AAC5B,oBAAoB,KAAK,EAAE,UAAU;AACrC,oBAAoB,WAAW,EAAE,iBAAiB;AAClD,oBAAoB,IAAI,EAAE,SAAS;AACnC,mBAAmB;AACnB,kBAAkB,KAAK,EAAE;AACzB,oBAAoB,KAAK,EAAE,OAAO;AAClC,oBAAoB,WAAW,EAAE,oCAAoC;AACrE,oBAAoB,IAAI,EAAE,SAAS;AACnC,mBAAmB;AACnB,kBAAkB,GAAG,EAAE;AACvB,oBAAoB,KAAK,EAAE,KAAK;AAChC,oBAAoB,WAAW,EAAE,8CAA8C;AAC/E,oBAAoB,IAAI,EAAE,SAAS;AACnC,mBAAmB;AACnB,kBAAkB,QAAQ,EAAE;AAC5B,oBAAoB,KAAK,EAAE,UAAU;AACrC,oBAAoB,WAAW,EAAE,qEAAqE;AACtG,oBAAoB,IAAI,EAAE,QAAQ;AAClC,mBAAmB;AACnB,kBAAkB,SAAS,EAAE;AAC7B,oBAAoB,KAAK,EAAE,WAAW;AACtC,oBAAoB,WAAW,EAAE,gGAAgG;AACjI,oBAAoB,IAAI,EAAE,QAAQ;AAClC,oBAAoB,IAAI,EAAE,CAAC,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,UAAU,CAAC;AACxE,mBAAmB;AACnB,kBAAkB,QAAQ,EAAE;AAC5B,oBAAoB,KAAK,EAAE,UAAU;AACrC,oBAAoB,WAAW,EAAE,mIAAmI;AACpK,oBAAoB,IAAI,EAAE,QAAQ;AAClC,oBAAoB,IAAI,EAAE;AAC1B,sBAAsB,OAAO;AAC7B,sBAAsB,YAAY;AAClC,sBAAsB,SAAS;AAC/B,sBAAsB,QAAQ;AAC9B,sBAAsB,WAAW;AACjC,sBAAsB,WAAW;AACjC,sBAAsB,aAAa;AACnC,sBAAsB,gBAAgB;AACtC,sBAAsB,MAAM;AAC5B,qBAAqB;AACrB,mBAAmB;AACnB,kBAAkB,YAAY,EAAE;AAChC,oBAAoB,KAAK,EAAE,0BAA0B;AACrD,oBAAoB,WAAW,EAAE,4GAA4G;AAC7I,oBAAoB,IAAI,EAAE,QAAQ;AAClC,oBAAoB,IAAI,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,CAAC;AAChE,mBAAmB;AACnB,iBAAiB;AACjB,eAAe;AACf,aAAa;AACb,WAAW;AACX,UAAU,SAAS,EAAE;AACrB,YAAY,KAAK,EAAE,oBAAoB;AACvC,YAAY,WAAW,EAAE,qFAAqF;AAC9G,YAAY,IAAI,EAAE,QAAQ;AAC1B,WAAW;AACX,SAAS;AACT,OAAO;AACP,KAAK;AACL,IAAI,MAAM,OAAO,CAAC,GAAG,EAAE;AACvB,MAAM,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AACrB,MAAM,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,0CAA0C,CAAC,CAAC;AAClE,MAAM,MAAM,OAAO,GAAG,MAAM,GAAG,CAAC,wBAAwB,EAAE,CAAC;AAC3D,MAAM,MAAM,SAAS,GAAGC,YAAW,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;AACvD,MAAM,MAAMC,qCAAa,CAAC;AAC1B,QAAQ,MAAM;AACd,QAAQ,YAAY;AACpB,QAAQ,OAAO,EAAE,CAAC,EAAE,GAAG,GAAG,CAAC,YAAY,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,OAAO;AACtE,QAAQ,QAAQ,EAAE,GAAG,CAAC,KAAK,CAAC,GAAG;AAC/B,QAAQ,UAAU,EAAE,OAAO;AAC3B,OAAO,CAAC,CAAC;AACT,MAAM,MAAM,cAAc,GAAG,IAAI,cAAc,CAAC,EAAE,eAAe,EAAE,CAAC,CAAC;AACrE,MAAM,MAAM,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC;AACtC,MAAM,IAAI,SAAS,IAAI,EAAE,CAAC,EAAE,GAAG,OAAO,CAAC,iBAAiB,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,EAAE;AACtG,QAAQ,MAAM,IAAI,KAAK,CAAC,CAAC,MAAM,EAAE,SAAS,CAAC,eAAe,CAAC,CAAC,CAAC;AAC7D,OAAO;AACP,MAAM,MAAM,cAAc,CAAC,GAAG,CAAC;AAC/B,QAAQ,aAAa,EAAE,OAAO;AAC9B,QAAQ,SAAS,EAAE,GAAG,CAAC,SAAS;AAChC,QAAQ,MAAM,EAAE,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,SAAS,EAAE;AAClD,OAAO,CAAC,CAAC;AACT,MAAM,MAAM,UAAU,GAAG,CAAC,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,UAAU,KAAK,IAAI,GAAG,EAAE,GAAG,IAAI,CAAC;AACzE,MAAM,MAAM,UAAU,GAAGD,YAAW,CAAC,GAAG,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;AACpE,MAAM,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE;AACrD,QAAQ,MAAM,IAAIE,iBAAU,CAAC,CAAC,4EAA4E,CAAC,CAAC,CAAC;AAC7G,OAAO;AACP,MAAM,MAAMN,sBAAE,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;AAC3C,KAAK;AACL,GAAG,CAAC,CAAC;AACL;;;;"}