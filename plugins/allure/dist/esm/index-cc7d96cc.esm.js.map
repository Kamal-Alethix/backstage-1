{"version":3,"file":"index-cc7d96cc.esm.js","sources":["../../src/api/AllureApi.ts","../../src/api/AllureApiClient.ts","../../src/plugin.ts","../../src/components/annotationHelpers.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createApiRef } from '@backstage/core-plugin-api';\n\nexport type AllureApi = {\n  getReportUrl(projectId: string): Promise<string>;\n};\n\nexport const allureApiRef = createApiRef<AllureApi>({\n  id: 'allure-api',\n});\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ConfigApi } from '@backstage/core-plugin-api';\nimport { AllureApi } from './AllureApi';\n\nexport class AllureApiClient implements AllureApi {\n  readonly configApi: ConfigApi;\n\n  constructor(options: { configApi: ConfigApi }) {\n    this.configApi = options.configApi;\n  }\n\n  async getReportUrl(projectId: string): Promise<string> {\n    const baseUrl = this.configApi.getString('allure.baseUrl');\n    return `${baseUrl}/projects/${projectId}/reports/latest/index.html`;\n  }\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  configApiRef,\n  createApiFactory,\n  createPlugin,\n  createRoutableExtension,\n  createRouteRef,\n} from '@backstage/core-plugin-api';\nimport { AllureApiClient, allureApiRef } from './api';\n\nexport const allureRouteRef = createRouteRef({\n  id: 'allure',\n});\n\nexport const allurePlugin = createPlugin({\n  id: 'allure',\n  apis: [\n    createApiFactory({\n      api: allureApiRef,\n      deps: {\n        configApi: configApiRef,\n      },\n      factory: ({ configApi }) => new AllureApiClient({ configApi }),\n    }),\n  ],\n  routes: {\n    root: allureRouteRef,\n  },\n});\n\nexport const EntityAllureReportContent = allurePlugin.provide(\n  createRoutableExtension({\n    name: 'EntityAllureReportContent',\n    component: () =>\n      import('./components/AllureReportComponent').then(\n        m => m.AllureReportComponent,\n      ),\n    mountPoint: allureRouteRef,\n  }),\n);\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Entity } from '@backstage/catalog-model';\n\nexport const ALLURE_PROJECT_ID_ANNOTATION = 'qameta.io/allure-project';\n\nexport const isAllureReportAvailable = (entity: Entity) =>\n  Boolean(entity.metadata.annotations?.[ALLURE_PROJECT_ID_ANNOTATION]);\n\nexport const getAllureProjectId = (entity: Entity) => {\n  return entity?.metadata.annotations?.[ALLURE_PROJECT_ID_ANNOTATION] ?? '';\n};\n"],"names":[],"mappings":";;AACY,MAAC,YAAY,GAAG,YAAY,CAAC;AACzC,EAAE,EAAE,EAAE,YAAY;AAClB,CAAC;;ACHM,MAAM,eAAe,CAAC;AAC7B,EAAE,WAAW,CAAC,OAAO,EAAE;AACvB,IAAI,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;AACvC,GAAG;AACH,EAAE,MAAM,YAAY,CAAC,SAAS,EAAE;AAChC,IAAI,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;AAC/D,IAAI,OAAO,CAAC,EAAE,OAAO,CAAC,UAAU,EAAE,SAAS,CAAC,0BAA0B,CAAC,CAAC;AACxE,GAAG;AACH;;ACAO,MAAM,cAAc,GAAG,cAAc,CAAC;AAC7C,EAAE,EAAE,EAAE,QAAQ;AACd,CAAC,CAAC,CAAC;AACS,MAAC,YAAY,GAAG,YAAY,CAAC;AACzC,EAAE,EAAE,EAAE,QAAQ;AACd,EAAE,IAAI,EAAE;AACR,IAAI,gBAAgB,CAAC;AACrB,MAAM,GAAG,EAAE,YAAY;AACvB,MAAM,IAAI,EAAE;AACZ,QAAQ,SAAS,EAAE,YAAY;AAC/B,OAAO;AACP,MAAM,OAAO,EAAE,CAAC,EAAE,SAAS,EAAE,KAAK,IAAI,eAAe,CAAC,EAAE,SAAS,EAAE,CAAC;AACpE,KAAK,CAAC;AACN,GAAG;AACH,EAAE,MAAM,EAAE;AACV,IAAI,IAAI,EAAE,cAAc;AACxB,GAAG;AACH,CAAC,EAAE;AACS,MAAC,yBAAyB,GAAG,YAAY,CAAC,OAAO,CAAC,uBAAuB,CAAC;AACtF,EAAE,IAAI,EAAE,2BAA2B;AACnC,EAAE,SAAS,EAAE,MAAM,OAAO,yBAAoC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,qBAAqB,CAAC;AACpG,EAAE,UAAU,EAAE,cAAc;AAC5B,CAAC,CAAC;;AC9BU,MAAC,4BAA4B,GAAG,2BAA2B;AAC3D,MAAC,uBAAuB,GAAG,CAAC,MAAM,KAAK;AACnD,EAAE,IAAI,EAAE,CAAC;AACT,EAAE,OAAO,OAAO,CAAC,CAAC,EAAE,GAAG,MAAM,CAAC,QAAQ,CAAC,WAAW,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,4BAA4B,CAAC,CAAC,CAAC;AACzG,EAAE;AACU,MAAC,kBAAkB,GAAG,CAAC,MAAM,KAAK;AAC9C,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACb,EAAE,OAAO,CAAC,EAAE,GAAG,CAAC,EAAE,GAAG,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC,WAAW,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,4BAA4B,CAAC,KAAK,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC;AACnJ;;;;"}