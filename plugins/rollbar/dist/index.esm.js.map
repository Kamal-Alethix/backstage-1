{"version":3,"file":"index.esm.js","sources":["../src/api/RollbarApi.ts","../src/api/RollbarClient.ts","../src/constants.ts","../src/hooks/useProject.ts","../src/hooks/useTopActiveItems.ts","../src/api/types.ts","../src/utils/index.ts","../src/components/TrendGraph/TrendGraph.tsx","../src/components/RollbarTopItemsTable/RollbarTopItemsTable.tsx","../src/components/RollbarProject/RollbarProject.tsx","../src/components/EntityPageRollbar/EntityPageRollbar.tsx","../src/components/Router.tsx","../src/plugin.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  RollbarItemsResponse,\n  RollbarProject,\n  RollbarTopActiveItem,\n} from './types';\nimport { createApiRef } from '@backstage/core-plugin-api';\n\nexport const rollbarApiRef = createApiRef<RollbarApi>({\n  id: 'plugin.rollbar.service',\n});\n\nexport interface RollbarApi {\n  getAllProjects(): Promise<RollbarProject[]>;\n  getProject(projectName: string): Promise<RollbarProject>;\n  getTopActiveItems(\n    project: string,\n    hours?: number,\n  ): Promise<RollbarTopActiveItem[]>;\n  getProjectItems(project: string): Promise<RollbarItemsResponse>;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RollbarApi } from './RollbarApi';\nimport {\n  RollbarItemsResponse,\n  RollbarProject,\n  RollbarTopActiveItem,\n} from './types';\nimport { DiscoveryApi, IdentityApi } from '@backstage/core-plugin-api';\n\nexport class RollbarClient implements RollbarApi {\n  private readonly discoveryApi: DiscoveryApi;\n  private readonly identityApi: IdentityApi;\n\n  constructor(options: {\n    discoveryApi: DiscoveryApi;\n    identityApi: IdentityApi;\n  }) {\n    this.discoveryApi = options.discoveryApi;\n    this.identityApi = options.identityApi;\n  }\n\n  async getAllProjects(): Promise<RollbarProject[]> {\n    return await this.get(`/projects`);\n  }\n\n  async getProject(projectName: string): Promise<RollbarProject> {\n    return await this.get(`/projects/${projectName}`);\n  }\n\n  async getTopActiveItems(\n    project: string,\n    hours = 24,\n    environment = 'production',\n  ): Promise<RollbarTopActiveItem[]> {\n    return await this.get(\n      `/projects/${project}/top_active_items?environment=${environment}&hours=${hours}`,\n    );\n  }\n\n  async getProjectItems(project: string): Promise<RollbarItemsResponse> {\n    return await this.get(`/projects/${project}/items`);\n  }\n\n  private async get(path: string): Promise<any> {\n    const url = `${await this.discoveryApi.getBaseUrl('rollbar')}${path}`;\n    const { token: idToken } = await this.identityApi.getCredentials();\n    const response = await fetch(url, {\n      headers: idToken ? { Authorization: `Bearer ${idToken}` } : {},\n    });\n\n    if (!response.ok) {\n      const payload = await response.text();\n      const message = `Request failed with ${response.status} ${response.statusText}, ${payload}`;\n      throw new Error(message);\n    }\n\n    return await response.json();\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const ROLLBAR_ANNOTATION = 'rollbar.com/project-slug';\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport { ROLLBAR_ANNOTATION } from '../constants';\nimport { useApi, configApiRef } from '@backstage/core-plugin-api';\n\nexport function useProjectSlugFromEntity(entity: Entity) {\n  const configApi = useApi(configApiRef);\n\n  const [project, organization] = (\n    entity?.metadata?.annotations?.[ROLLBAR_ANNOTATION] ?? ''\n  )\n    .split('/')\n    .reverse();\n\n  return {\n    project,\n    organization:\n      organization ??\n      configApi.getOptionalString('rollbar.organization') ??\n      configApi.getString('organization.name'),\n  };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport useAsync from 'react-use/lib/useAsync';\nimport { Entity } from '@backstage/catalog-model';\nimport { rollbarApiRef } from '../api';\nimport { RollbarTopActiveItem } from '../api/types';\nimport { useProjectSlugFromEntity } from './useProject';\nimport { useApi } from '@backstage/core-plugin-api';\n\nexport function useTopActiveItems(entity: Entity) {\n  const api = useApi(rollbarApiRef);\n  const { organization, project } = useProjectSlugFromEntity(entity);\n  const { value, loading, error } = useAsync(() => {\n    if (!project) {\n      return Promise.resolve([]);\n    }\n\n    return api\n      .getTopActiveItems(project, 168)\n      .then(data =>\n        data.sort((a, b) => b.item.occurrences - a.item.occurrences),\n      );\n  }, [api, organization, project, entity]);\n\n  return {\n    items: value as RollbarTopActiveItem[],\n    organization,\n    project,\n    loading,\n    error,\n  };\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// TODO: Make this shared/dry with backend\n\nexport type RollbarProjectAccessTokenScope = 'read' | 'write';\nexport type RollbarEnvironment = 'production' | string;\n\nexport enum RollbarLevel {\n  debug = 10,\n  info = 20,\n  warning = 30,\n  error = 40,\n  critical = 50,\n}\n\nexport enum RollbarFrameworkId {\n  'unknown' = 0,\n  'rails' = 1,\n  'django' = 2,\n  'pyramid' = 3,\n  'node-js' = 4,\n  'pylons' = 5,\n  'php' = 6,\n  'browser-js' = 7,\n  'rollbar-system' = 8,\n  'android' = 9,\n  'ios' = 10,\n  'mailgun' = 11,\n  'logentries' = 12,\n  'python' = 13,\n  'ruby' = 14,\n  'sidekiq' = 15,\n  'flask' = 16,\n  'celery' = 17,\n  'rq' = 18,\n}\n\nexport enum RollbarPlatformId {\n  'unknown' = 0,\n  'browser' = 1,\n  'flash' = 2,\n  'android' = 3,\n  'ios' = 4,\n  'heroku' = 5,\n  'google-app-engine' = 6,\n  'client' = 7,\n}\n\nexport type RollbarProject = {\n  id: number;\n  name: string;\n  accountId: number;\n  status: 'enabled' | string;\n};\n\nexport type RollbarProjectAccessToken = {\n  projectId: number;\n  name: string;\n  scopes: RollbarProjectAccessTokenScope[];\n  accessToken: string;\n  status: 'enabled' | string;\n};\n\nexport type RollbarItem = {\n  publicItemId: number;\n  integrationsData: null;\n  levelLock: number;\n  controllingId: number;\n  lastActivatedTimestamp: number;\n  assignedUserId: number;\n  groupStatus: number;\n  hash: string;\n  id: number;\n  environment: RollbarEnvironment;\n  titleLock: number;\n  title: string;\n  lastOccurrenceId: number;\n  lastOccurrenceTimestamp: number;\n  platform: RollbarPlatformId;\n  firstOccurrenceTimestamp: number;\n  project_id: number;\n  resolvedInVersion: string;\n  status: 'enabled' | string;\n  uniqueOccurrences: number;\n  groupItemId: number;\n  framework: RollbarFrameworkId;\n  totalOccurrences: number;\n  level: RollbarLevel;\n  counter: number;\n  lastModifiedBy: number;\n  firstOccurrenceId: number;\n  activatingOccurrenceId: number;\n  lastResolvedTimestamp: number;\n};\n\nexport type RollbarItemsResponse = {\n  items: RollbarItem[];\n  page: number;\n  totalCount: number;\n};\n\nexport type RollbarItemCount = {\n  timestamp: number;\n  count: number;\n};\n\nexport type RollbarTopActiveItem = {\n  item: {\n    id: number;\n    counter: number;\n    environment: RollbarEnvironment;\n    framework: RollbarFrameworkId;\n    lastOccurrenceTimestamp: number;\n    level: number;\n    occurrences: number;\n    projectId: number;\n    title: string;\n    uniqueOccurrences: number;\n  };\n  counts: number[];\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const buildProjectUrl = (org: string, id: number) =>\n  `https://rollbar.com/${org}/all/items/?projects=${id}`;\n\nexport const buildItemUrl = (org: string, project: string, id: number) =>\n  `https://rollbar.com/${org}/${project}/items/${id}`;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Sparklines, SparklinesBars } from 'react-sparklines';\n\ntype Props = {\n  counts: number[];\n};\n\nexport const TrendGraph = ({ counts }: Props) => {\n  return (\n    <Sparklines data={counts} svgHeight={48} min={0} margin={4}>\n      <SparklinesBars barWidth={2} />\n    </Sparklines>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Box, Link, Typography } from '@material-ui/core';\nimport { Alert } from '@material-ui/lab';\nimport React from 'react';\nimport {\n  RollbarFrameworkId,\n  RollbarLevel,\n  RollbarTopActiveItem,\n} from '../../api/types';\nimport { buildItemUrl } from '../../utils';\nimport { TrendGraph } from '../TrendGraph/TrendGraph';\nimport { Table, TableColumn } from '@backstage/core-components';\n\nconst columns: TableColumn[] = [\n  {\n    title: 'ID',\n    field: 'item.counter',\n    type: 'string',\n    align: 'left',\n    width: '70px',\n    render: (data: any) => (\n      <Link\n        href={buildItemUrl(data.org, data.project, data.item.counter)}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {data.item.counter}\n      </Link>\n    ),\n  },\n  {\n    title: 'Title',\n    field: 'item.title',\n    type: 'string',\n    align: 'left',\n  },\n  {\n    title: 'Trend',\n    sorting: false,\n    render: (data: any) => <TrendGraph counts={data.counts} />,\n  },\n  {\n    title: 'Occurrences',\n    field: 'item.occurrences',\n    type: 'numeric',\n    align: 'right',\n  },\n  {\n    title: 'Environment',\n    field: 'item.environment',\n    type: 'string',\n  },\n  {\n    title: 'Level',\n    field: 'item.level',\n    type: 'string',\n    render: data => RollbarLevel[(data as RollbarTopActiveItem).item.level],\n  },\n  {\n    title: 'Framework',\n    field: 'item.framework',\n    type: 'string',\n    render: data =>\n      RollbarFrameworkId[(data as RollbarTopActiveItem).item.framework],\n  },\n  {\n    title: 'Last Occurrence',\n    field: 'item.lastOccurrenceTimestamp',\n    type: 'datetime',\n    render: data =>\n      new Date(\n        (data as RollbarTopActiveItem).item.lastOccurrenceTimestamp * 1000,\n      ).toLocaleDateString(),\n  },\n];\n\ntype Props = {\n  items: RollbarTopActiveItem[];\n  organization: string;\n  project: string;\n  loading: boolean;\n  error?: any;\n};\n\nexport const RollbarTopItemsTable = ({\n  items,\n  organization,\n  project,\n  loading,\n  error,\n}: Props) => {\n  if (error) {\n    return (\n      <div>\n        <Alert severity=\"error\">\n          Error encountered while fetching rollbar top items. {error.toString()}\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <Table\n      isLoading={loading}\n      columns={columns}\n      options={{\n        padding: 'dense',\n        search: true,\n        paging: true,\n        pageSize: 5,\n        showEmptyDataSourceMessage: !loading,\n      }}\n      title={\n        <Box display=\"flex\" alignItems=\"center\">\n          <Box mr={1} />\n          <Typography variant=\"h6\">Top Active Items / {project}</Typography>\n        </Box>\n      }\n      data={items.map(i => ({ org: organization, project, ...i }))}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport React from 'react';\nimport { useTopActiveItems } from '../../hooks/useTopActiveItems';\nimport { RollbarTopItemsTable } from '../RollbarTopItemsTable/RollbarTopItemsTable';\n\ntype Props = {\n  entity: Entity;\n};\n\nexport const RollbarProject = ({ entity }: Props) => {\n  const { items, organization, project, loading, error } =\n    useTopActiveItems(entity);\n\n  return (\n    <RollbarTopItemsTable\n      organization={organization}\n      project={project}\n      items={items || []}\n      loading={loading}\n      error={error}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport React from 'react';\nimport { RollbarProject } from '../RollbarProject/RollbarProject';\n\nexport const EntityPageRollbar = () => {\n  const { entity } = useEntity();\n\n  return <RollbarProject entity={entity} />;\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport React from 'react';\nimport { Route, Routes } from 'react-router';\nimport { ROLLBAR_ANNOTATION } from '../constants';\nimport { EntityPageRollbar } from './EntityPageRollbar/EntityPageRollbar';\nimport { MissingAnnotationEmptyState } from '@backstage/core-components';\n\nexport const isPluginApplicableToEntity = (entity: Entity) =>\n  Boolean(entity.metadata.annotations?.[ROLLBAR_ANNOTATION]);\n\ntype Props = {};\n\nexport const Router = (_props: Props) => {\n  const { entity } = useEntity();\n\n  if (!isPluginApplicableToEntity(entity)) {\n    <MissingAnnotationEmptyState annotation={ROLLBAR_ANNOTATION} />;\n  }\n\n  return (\n    <Routes>\n      <Route path=\"/\" element={<EntityPageRollbar />} />\n    </Routes>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { rollbarApiRef } from './api/RollbarApi';\nimport { RollbarClient } from './api/RollbarClient';\nimport {\n  createApiFactory,\n  createPlugin,\n  createRoutableExtension,\n  createRouteRef,\n  discoveryApiRef,\n  identityApiRef,\n} from '@backstage/core-plugin-api';\n\nexport const rootRouteRef = createRouteRef({\n  id: 'rollbar',\n});\n\nexport const rollbarPlugin = createPlugin({\n  id: 'rollbar',\n  apis: [\n    createApiFactory({\n      api: rollbarApiRef,\n      deps: { discoveryApi: discoveryApiRef, identityApi: identityApiRef },\n      factory: ({ discoveryApi, identityApi }) =>\n        new RollbarClient({ discoveryApi, identityApi }),\n    }),\n  ],\n  routes: {\n    entityContent: rootRouteRef,\n  },\n});\n\nexport const EntityRollbarContent = rollbarPlugin.provide(\n  createRoutableExtension({\n    name: 'EntityRollbarContent',\n    component: () => import('./components/Router').then(m => m.Router),\n    mountPoint: rootRouteRef,\n  }),\n);\n"],"names":[],"mappings":"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"}