{"version":3,"file":"index-7674c077.esm.js","sources":["../../src/components/TodoList/TodoList.tsx"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport React, { useState } from 'react';\nimport { todoApiRef } from '../../api';\nimport { TodoItem, TodoListOptions } from '../../api/types';\n\nimport {\n  Table,\n  TableColumn,\n  OverflowTooltip,\n  Link,\n  ResponseErrorPanel,\n} from '@backstage/core-components';\nimport { useApi } from '@backstage/core-plugin-api';\n\nconst PAGE_SIZE = 10;\n\nconst columns: TableColumn<TodoItem>[] = [\n  {\n    title: 'Tag',\n    field: 'tag',\n    width: '10%',\n    filtering: false,\n  },\n  {\n    title: 'Text',\n    field: 'text',\n    width: '55%',\n    highlight: true,\n    render: ({ text }) => <OverflowTooltip text={text} />,\n  },\n  {\n    title: 'File',\n    field: 'repoFilePath',\n    width: '25%',\n    render: ({ viewUrl, repoFilePath }) =>\n      viewUrl ? (\n        <Link to={viewUrl} target=\"_blank\">\n          <OverflowTooltip text={repoFilePath} />\n        </Link>\n      ) : (\n        <OverflowTooltip text={repoFilePath} />\n      ),\n  },\n  {\n    title: 'Author',\n    field: 'author',\n    width: '10%',\n    render: ({ author }) => <OverflowTooltip text={author} />,\n  },\n];\n\nexport const TodoList = () => {\n  const { entity } = useEntity();\n  const todoApi = useApi(todoApiRef);\n  const [error, setError] = useState<Error>();\n\n  if (error) {\n    return <ResponseErrorPanel error={error} />;\n  }\n\n  return (\n    <Table<TodoItem>\n      title=\"TODOs\"\n      options={{\n        search: false,\n        pageSize: PAGE_SIZE,\n        padding: 'dense',\n        sorting: true,\n        draggable: false,\n        paging: true,\n        filtering: true,\n        debounceInterval: 500,\n        filterCellStyle: { padding: '0 16px 0 20px' },\n      }}\n      columns={columns}\n      data={async query => {\n        try {\n          const page = query?.page ?? 0;\n          const pageSize = query?.pageSize ?? PAGE_SIZE;\n          const result = await todoApi.listTodos({\n            entity,\n            offset: page * pageSize,\n            limit: pageSize,\n            orderBy:\n              query?.orderBy &&\n              ({\n                field: query.orderBy.field,\n                direction: query.orderDirection,\n              } as TodoListOptions['orderBy']),\n            filters: query?.filters?.map(filter => ({\n              field: filter.column.field!,\n              value: `*${filter.value}*`,\n            })) as TodoListOptions['filters'],\n          });\n          return {\n            data: result.items,\n            totalCount: result.totalCount,\n            page: Math.floor(result.offset / result.limit),\n          };\n        } catch (loadingError) {\n          setError(loadingError);\n          return { data: [], totalCount: 0, page: 0 };\n        }\n      }}\n    />\n  );\n};\n"],"names":[],"mappings":"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"}