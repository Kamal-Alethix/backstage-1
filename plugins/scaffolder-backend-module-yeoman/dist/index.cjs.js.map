{"version":3,"file":"index.cjs.js","sources":["../src/actions/run/yeomanRun.ts","../src/actions/run/yeoman.ts"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { JsonObject } from '@backstage/types';\n\n/*\n * This module should use '@types/yeoman-environment' eventually as soon as '@types/yeoman-environment' supports\n * the latest version of Yeoman -> 3.x. Then it will be possible to test this module with jest.\n */\n\nexport async function yeomanRun(\n  workspace: string,\n  namespace: string,\n  args?: string[],\n  opts?: JsonObject,\n) {\n  const yeoman = require('yeoman-environment');\n  const generator = yeoman.lookupGenerator(namespace);\n  const env = yeoman.createEnv(undefined, { cwd: workspace });\n  env.register(generator, namespace);\n  const yeomanArgs = [namespace, ...(args ?? [])];\n  await env.run(yeomanArgs, opts);\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { JsonObject } from '@backstage/types';\nimport { createTemplateAction } from '@backstage/plugin-scaffolder-backend';\nimport { yeomanRun } from './yeomanRun';\n\n/**\n * Creates a `run:yeoman` Scaffolder action.\n *\n * @remarks\n *\n * See {@link https://yeoman.io/} and {@link https://backstage.io/docs/features/software-templates/writing-custom-actions}.\n *\n * @public\n */\nexport function createRunYeomanAction() {\n  return createTemplateAction<{\n    namespace: string;\n    args?: string[];\n    options?: JsonObject;\n  }>({\n    id: 'run:yeoman',\n    description: 'Runs Yeoman on an installed Yeoman generator',\n    schema: {\n      input: {\n        type: 'object',\n        required: ['namespace'],\n        properties: {\n          namespace: {\n            title: 'Generator Namespace',\n            description: 'Yeoman generator namespace, e.g: node:app',\n            type: 'string',\n          },\n          args: {\n            title: 'Generator Arguments',\n            description: 'Arguments to pass on to Yeoman for templating',\n            type: 'array',\n            items: {\n              type: 'string',\n            },\n          },\n          options: {\n            title: 'Generator Options',\n            description: 'Options to pass on to Yeoman for templating',\n            type: 'object',\n          },\n        },\n      },\n    },\n    async handler(ctx) {\n      ctx.logger.info(\n        `Templating using Yeoman generator: ${ctx.input.namespace}`,\n      );\n      await yeomanRun(\n        ctx.workspacePath,\n        ctx.input.namespace,\n        ctx.input.args,\n        ctx.input.options,\n      );\n    },\n  });\n}\n"],"names":["createTemplateAction"],"mappings":";;;;;;AAAO,eAAe,SAAS,CAAC,SAAS,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE;AAClE,EAAE,MAAM,MAAM,GAAG,OAAO,CAAC,oBAAoB,CAAC,CAAC;AAC/C,EAAE,MAAM,SAAS,GAAG,MAAM,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;AACtD,EAAE,MAAM,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE,CAAC,CAAC;AAC3D,EAAE,GAAG,CAAC,QAAQ,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;AACrC,EAAE,MAAM,UAAU,GAAG,CAAC,SAAS,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG,IAAI,GAAG,EAAE,CAAC,CAAC;AAC9D,EAAE,MAAM,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;AAClC;;ACLO,SAAS,qBAAqB,GAAG;AACxC,EAAE,OAAOA,4CAAoB,CAAC;AAC9B,IAAI,EAAE,EAAE,YAAY;AACpB,IAAI,WAAW,EAAE,8CAA8C;AAC/D,IAAI,MAAM,EAAE;AACZ,MAAM,KAAK,EAAE;AACb,QAAQ,IAAI,EAAE,QAAQ;AACtB,QAAQ,QAAQ,EAAE,CAAC,WAAW,CAAC;AAC/B,QAAQ,UAAU,EAAE;AACpB,UAAU,SAAS,EAAE;AACrB,YAAY,KAAK,EAAE,qBAAqB;AACxC,YAAY,WAAW,EAAE,2CAA2C;AACpE,YAAY,IAAI,EAAE,QAAQ;AAC1B,WAAW;AACX,UAAU,IAAI,EAAE;AAChB,YAAY,KAAK,EAAE,qBAAqB;AACxC,YAAY,WAAW,EAAE,+CAA+C;AACxE,YAAY,IAAI,EAAE,OAAO;AACzB,YAAY,KAAK,EAAE;AACnB,cAAc,IAAI,EAAE,QAAQ;AAC5B,aAAa;AACb,WAAW;AACX,UAAU,OAAO,EAAE;AACnB,YAAY,KAAK,EAAE,mBAAmB;AACtC,YAAY,WAAW,EAAE,6CAA6C;AACtE,YAAY,IAAI,EAAE,QAAQ;AAC1B,WAAW;AACX,SAAS;AACT,OAAO;AACP,KAAK;AACL,IAAI,MAAM,OAAO,CAAC,GAAG,EAAE;AACvB,MAAM,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,mCAAmC,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;AACnF,MAAM,MAAM,SAAS,CAAC,GAAG,CAAC,aAAa,EAAE,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AACjG,KAAK;AACL,GAAG,CAAC,CAAC;AACL;;;;"}