{"version":3,"file":"index.esm.js","sources":["../src/api/mock/mock-api.ts","../src/api/sentry-api.ts","../src/api/production-api.ts","../src/components/ErrorCell/ErrorCell.tsx","../src/components/ErrorGraph/ErrorGraph.tsx","../src/components/SentryIssuesTable/SentryIssuesTable.tsx","../src/components/useProjectSlug.ts","../src/components/SentryIssuesWidget/SentryIssuesWidget.tsx","../src/components/isSentryAvailable.ts","../src/plugin.ts","../src/extensions.tsx","../src/components/Router.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SentryIssue } from '../sentry-issue';\nimport { SentryApi } from '../sentry-api';\nimport mockData from './sentry-issue-mock.json';\n\nfunction getMockIssue(): SentryIssue {\n  const randomizedStats = {\n    '24h': new Array(24)\n      .fill(0)\n      .map(() => [0, Math.floor(Math.random() * 100)]),\n  };\n  return {\n    ...mockData,\n    userCount: Math.floor(Math.random() * 1000),\n    stats: randomizedStats,\n  };\n}\nfunction getMockIssues(number: number): SentryIssue[] {\n  return new Array(number).fill(0).map(getMockIssue);\n}\nexport class MockSentryApi implements SentryApi {\n  fetchIssues(): Promise<SentryIssue[]> {\n    return new Promise(resolve => {\n      setTimeout(() => resolve(getMockIssues(14)), 800);\n    });\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SentryIssue } from './sentry-issue';\nimport { createApiRef } from '@backstage/core-plugin-api';\n\nexport const sentryApiRef = createApiRef<SentryApi>({\n  id: 'plugin.sentry.service',\n});\n\nexport interface SentryApi {\n  fetchIssues(\n    project: string,\n    statsFor: string,\n    query?: string,\n  ): Promise<SentryIssue[]>;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SentryIssue } from './sentry-issue';\nimport { SentryApi } from './sentry-api';\nimport { DiscoveryApi, IdentityApi } from '@backstage/core-plugin-api';\n\nexport class ProductionSentryApi implements SentryApi {\n  constructor(\n    private readonly discoveryApi: DiscoveryApi,\n    private readonly organization: string,\n    private readonly identityApi?: IdentityApi,\n  ) {}\n\n  async fetchIssues(\n    project: string,\n    statsFor: string,\n    query?: string,\n  ): Promise<SentryIssue[]> {\n    if (!project) {\n      return [];\n    }\n\n    const apiUrl = `${await this.discoveryApi.getBaseUrl('proxy')}/sentry/api`;\n    const options = await this.authOptions();\n\n    const queryPart = query ? `&query=${query}` : '';\n\n    const response = await fetch(\n      `${apiUrl}/0/projects/${this.organization}/${project}/issues/?statsPeriod=${statsFor}${queryPart}`,\n      options,\n    );\n\n    if (response.status >= 400 && response.status < 600) {\n      throw new Error('Failed fetching Sentry issues');\n    }\n\n    return (await response.json()) as SentryIssue[];\n  }\n\n  private async authOptions() {\n    if (!this.identityApi) {\n      return {};\n    }\n    const { token } = await this.identityApi.getCredentials();\n    return {\n      headers: {\n        authorization: `Bearer ${token}`,\n      },\n    };\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { SentryIssue } from '../../api';\nimport { Typography } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { BackstageTheme } from '@backstage/theme';\nimport { Link } from '@backstage/core-components';\n\nfunction stripText(text: string, maxLength: number) {\n  return text.length > maxLength ? `${text.substr(0, maxLength)}...` : text;\n}\nconst useStyles = makeStyles<BackstageTheme>(theme => ({\n  root: {\n    minWidth: 260,\n    position: 'relative',\n    '&::before': {\n      left: -16,\n      position: 'absolute',\n      width: '4px',\n      height: '100%',\n      content: '\"\"',\n      backgroundColor: theme.palette.status.error,\n      borderRadius: 2,\n    },\n  },\n  text: {\n    marginBottom: 0,\n  },\n}));\n\nexport const ErrorCell = ({ sentryIssue }: { sentryIssue: SentryIssue }) => {\n  const classes = useStyles();\n  let issueType = '[No Type]';\n  if (sentryIssue.metadata.type) {\n    issueType = sentryIssue.metadata.type;\n  } else if (sentryIssue.title) {\n    issueType = sentryIssue.title;\n  }\n\n  return (\n    <div className={classes.root}>\n      <Link to={sentryIssue.permalink}>\n        <Typography variant=\"body1\" gutterBottom className={classes.text}>\n          {stripText(issueType, 28)}\n        </Typography>\n      </Link>\n      <Typography\n        variant=\"caption\"\n        display=\"block\"\n        gutterBottom\n        className={classes.text}\n      >\n        {sentryIssue.metadata.value &&\n          stripText(sentryIssue.metadata.value, 48)}\n      </Typography>\n    </div>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { SentryIssue } from '../../api';\nimport { Sparklines, SparklinesBars } from 'react-sparklines';\n\nexport const ErrorGraph = ({ sentryIssue }: { sentryIssue: SentryIssue }) => {\n  const data =\n    '14d' in sentryIssue.stats\n      ? sentryIssue.stats['14d']\n      : sentryIssue.stats['24h'];\n\n  return (\n    <Sparklines data={data?.map(([, val]) => val)} svgHeight={48} margin={4}>\n      <SparklinesBars />\n    </Sparklines>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { SentryIssue } from '../../api';\nimport { DateTime } from 'luxon';\nimport { ErrorCell } from '../ErrorCell/ErrorCell';\nimport { ErrorGraph } from '../ErrorGraph/ErrorGraph';\nimport { Table, TableColumn } from '@backstage/core-components';\nimport { Options } from '@material-table/core';\n\nconst columns: TableColumn[] = [\n  {\n    title: 'Error',\n    render: data => <ErrorCell sentryIssue={data as SentryIssue} />,\n  },\n  {\n    title: 'Graph',\n    render: data => <ErrorGraph sentryIssue={data as SentryIssue} />,\n  },\n  {\n    title: 'First seen',\n    field: 'firstSeen',\n    render: data => {\n      const { firstSeen } = data as SentryIssue;\n\n      return DateTime.fromISO(firstSeen).toRelative({ locale: 'en' });\n    },\n  },\n  {\n    title: 'Last seen',\n    field: 'lastSeen',\n    render: data => {\n      const { lastSeen } = data as SentryIssue;\n      return DateTime.fromISO(lastSeen).toRelative({ locale: 'en' });\n    },\n  },\n  {\n    title: 'Events',\n    field: 'count',\n  },\n  {\n    title: 'Users',\n    field: 'userCount',\n  },\n];\n\ntype SentryIssuesTableProps = {\n  sentryIssues: SentryIssue[];\n  statsFor: '24h' | '14d' | '';\n  tableOptions: Options<never>;\n};\n\nconst SentryIssuesTable = ({\n  sentryIssues,\n  statsFor,\n  tableOptions,\n}: SentryIssuesTableProps) => {\n  return (\n    <Table\n      columns={columns}\n      options={tableOptions}\n      title=\"Sentry issues\"\n      subtitle={statsFor ? `Last ${statsFor}` : undefined}\n      data={sentryIssues}\n    />\n  );\n};\n\nexport default SentryIssuesTable;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\n\nexport const SENTRY_PROJECT_SLUG_ANNOTATION = 'sentry.io/project-slug';\n\nexport const useProjectSlug = (entity: Entity) => {\n  return entity?.metadata.annotations?.[SENTRY_PROJECT_SLUG_ANNOTATION] ?? '';\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport React, { useEffect } from 'react';\nimport useAsync from 'react-use/lib/useAsync';\nimport { sentryApiRef } from '../../api';\nimport SentryIssuesTable from '../SentryIssuesTable/SentryIssuesTable';\nimport {\n  SENTRY_PROJECT_SLUG_ANNOTATION,\n  useProjectSlug,\n} from '../useProjectSlug';\n\nimport {\n  EmptyState,\n  InfoCard,\n  InfoCardVariants,\n  MissingAnnotationEmptyState,\n  Progress,\n} from '@backstage/core-components';\n\nimport { ErrorApi, errorApiRef, useApi } from '@backstage/core-plugin-api';\nimport { Options } from '@material-table/core';\n\nexport const SentryIssuesWidget = ({\n  entity,\n  statsFor,\n  tableOptions,\n  variant = 'gridItem',\n  query = '',\n}: {\n  entity: Entity;\n  statsFor: '24h' | '14d' | '';\n  tableOptions: Options<never>;\n  variant?: InfoCardVariants;\n  query?: string;\n}) => {\n  const errorApi = useApi<ErrorApi>(errorApiRef);\n  const sentryApi = useApi(sentryApiRef);\n\n  const projectId = useProjectSlug(entity);\n\n  const { loading, value, error } = useAsync(\n    () => sentryApi.fetchIssues(projectId, statsFor, query),\n    [sentryApi, statsFor, projectId, query],\n  );\n\n  useEffect(() => {\n    if (error) {\n      errorApi.post(error);\n    }\n  }, [error, errorApi]);\n\n  if (loading || !projectId || error) {\n    return (\n      <InfoCard title=\"Sentry issues\" variant={variant}>\n        {loading && <Progress />}\n\n        {!loading && !projectId && (\n          <MissingAnnotationEmptyState\n            annotation={SENTRY_PROJECT_SLUG_ANNOTATION}\n          />\n        )}\n\n        {!loading && error && (\n          <EmptyState\n            missing=\"info\"\n            title=\"No information to display\"\n            description={`There is no Sentry project with id '${projectId}'.`}\n          />\n        )}\n      </InfoCard>\n    );\n  }\n\n  return (\n    <SentryIssuesTable\n      sentryIssues={value || []}\n      statsFor={statsFor}\n      tableOptions={tableOptions}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport { SENTRY_PROJECT_SLUG_ANNOTATION } from './useProjectSlug';\n\n/**\n * @public\n * Checks to see if sentry is available\n */\nexport const isSentryAvailable = (entity: Entity) =>\n  Boolean(entity.metadata.annotations?.[SENTRY_PROJECT_SLUG_ANNOTATION]);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ProductionSentryApi, sentryApiRef } from './api';\nimport {\n  configApiRef,\n  createApiFactory,\n  createPlugin,\n  createRouteRef,\n  discoveryApiRef,\n  identityApiRef,\n} from '@backstage/core-plugin-api';\n\nexport const rootRouteRef = createRouteRef({\n  id: 'sentry',\n});\n\nexport const sentryPlugin = createPlugin({\n  id: 'sentry',\n  apis: [\n    createApiFactory({\n      api: sentryApiRef,\n      deps: {\n        configApi: configApiRef,\n        discoveryApi: discoveryApiRef,\n        identityApi: identityApiRef,\n      },\n      factory: ({ configApi, discoveryApi, identityApi }) =>\n        new ProductionSentryApi(\n          discoveryApi,\n          configApi.getString('sentry.organization'),\n          identityApi,\n        ),\n    }),\n  ],\n  routes: {\n    root: rootRouteRef,\n  },\n});\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport React from 'react';\nimport { sentryPlugin, rootRouteRef } from './plugin';\nimport {\n  createComponentExtension,\n  createRoutableExtension,\n} from '@backstage/core-plugin-api';\nimport { Options } from '@material-table/core';\n\ntype SentryPageProps = {\n  statsFor?: '24h' | '14d' | '';\n  tableOptions?: Options<never>;\n};\n\nexport const EntitySentryContent = sentryPlugin.provide(\n  createRoutableExtension({\n    name: 'EntitySentryContent',\n    mountPoint: rootRouteRef,\n    component: () =>\n      import('./components/SentryIssuesWidget').then(\n        ({ SentryIssuesWidget }) => {\n          const SentryPage = ({ statsFor, tableOptions }: SentryPageProps) => {\n            const { entity } = useEntity();\n            const defaultOptions: Options<never> = {\n              padding: 'dense',\n              paging: true,\n              search: false,\n              pageSize: 5,\n            };\n            return (\n              <SentryIssuesWidget\n                entity={entity}\n                statsFor={statsFor || '24h'}\n                tableOptions={{ ...defaultOptions, ...tableOptions }}\n              />\n            );\n          };\n          return SentryPage;\n        },\n      ),\n  }),\n);\n\nexport const EntitySentryCard = sentryPlugin.provide(\n  createComponentExtension({\n    name: 'EntitySentryCard',\n    component: {\n      lazy: () =>\n        import('./components/SentryIssuesWidget').then(\n          ({ SentryIssuesWidget }) => {\n            const SentryCard = ({\n              statsFor,\n              tableOptions,\n            }: SentryPageProps) => {\n              const { entity } = useEntity();\n              return (\n                <SentryIssuesWidget\n                  entity={entity}\n                  statsFor={statsFor || '24h'}\n                  tableOptions={\n                    tableOptions || {\n                      padding: 'dense',\n                      paging: true,\n                      search: false,\n                      pageSize: 5,\n                    }\n                  }\n                />\n              );\n            };\n            return SentryCard;\n          },\n        ),\n    },\n  }),\n);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Entity } from '@backstage/catalog-model';\nimport { Route, Routes } from 'react-router';\nimport { SentryIssuesWidget } from './SentryIssuesWidget';\n\nexport const Router = ({ entity }: { entity: Entity }) => {\n  return (\n    <Routes>\n      <Route\n        path=\"/\"\n        element={\n          <SentryIssuesWidget\n            entity={entity}\n            statsFor=\"24h\"\n            tableOptions={{\n              padding: 'dense',\n              paging: true,\n              search: false,\n              pageSize: 5,\n            }}\n          />\n        }\n      />\n      )\n    </Routes>\n  );\n};\n"],"names":[],"mappings":"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"}