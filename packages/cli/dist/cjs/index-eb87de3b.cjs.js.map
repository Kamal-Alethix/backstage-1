{"version":3,"file":"index-eb87de3b.cjs.js","sources":["../../src/commands/build/command.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { OptionValues } from 'commander';\nimport { buildPackage, Output } from '../../lib/builder';\nimport { findRoleFromCommand, getRoleInfo } from '../../lib/role';\nimport { paths } from '../../lib/paths';\nimport { buildFrontend } from './buildFrontend';\nimport { buildBackend } from './buildBackend';\n\nexport async function command(opts: OptionValues): Promise<void> {\n  const role = await findRoleFromCommand(opts);\n\n  if (role === 'frontend') {\n    return buildFrontend({\n      targetDir: paths.targetDir,\n      configPaths: opts.config as string[],\n      writeStats: Boolean(opts.stats),\n    });\n  }\n  if (role === 'backend') {\n    return buildBackend({\n      targetDir: paths.targetDir,\n      skipBuildDependencies: Boolean(opts.skipBuildDependencies),\n    });\n  }\n\n  const roleInfo = getRoleInfo(role);\n\n  const outputs = new Set<Output>();\n\n  if (roleInfo.output.includes('cjs')) {\n    outputs.add(Output.cjs);\n  }\n  if (roleInfo.output.includes('esm')) {\n    outputs.add(Output.esm);\n  }\n  if (roleInfo.output.includes('types')) {\n    outputs.add(Output.types);\n  }\n\n  return buildPackage({\n    outputs,\n    minify: Boolean(opts.minify),\n    useApiExtractor: Boolean(opts.experimentalTypeBuild),\n  });\n}\n"],"names":["findRoleFromCommand","buildFrontend","paths","buildBackend","getRoleInfo","Output","buildPackage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKO,eAAe,OAAO,CAAC,IAAI,EAAE;AACpC,EAAE,MAAM,IAAI,GAAG,MAAMA,gCAAmB,CAAC,IAAI,CAAC,CAAC;AAC/C,EAAE,IAAI,IAAI,KAAK,UAAU,EAAE;AAC3B,IAAI,OAAOC,0BAAa,CAAC;AACzB,MAAM,SAAS,EAAEC,WAAK,CAAC,SAAS;AAChC,MAAM,WAAW,EAAE,IAAI,CAAC,MAAM;AAC9B,MAAM,UAAU,EAAE,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;AACrC,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,IAAI,IAAI,KAAK,SAAS,EAAE;AAC1B,IAAI,OAAOC,yBAAY,CAAC;AACxB,MAAM,SAAS,EAAED,WAAK,CAAC,SAAS;AAChC,MAAM,qBAAqB,EAAE,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC;AAChE,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,MAAM,QAAQ,GAAGE,wBAAW,CAAC,IAAI,CAAC,CAAC;AACrC,EAAE,MAAM,OAAO,mBAAmB,IAAI,GAAG,EAAE,CAAC;AAC5C,EAAE,IAAI,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;AACvC,IAAI,OAAO,CAAC,GAAG,CAACC,eAAM,CAAC,GAAG,CAAC,CAAC;AAC5B,GAAG;AACH,EAAE,IAAI,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;AACvC,IAAI,OAAO,CAAC,GAAG,CAACA,eAAM,CAAC,GAAG,CAAC,CAAC;AAC5B,GAAG;AACH,EAAE,IAAI,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE;AACzC,IAAI,OAAO,CAAC,GAAG,CAACA,eAAM,CAAC,KAAK,CAAC,CAAC;AAC9B,GAAG;AACH,EAAE,OAAOC,qBAAY,CAAC;AACtB,IAAI,OAAO;AACX,IAAI,MAAM,EAAE,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC;AAChC,IAAI,eAAe,EAAE,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC;AACxD,GAAG,CAAC,CAAC;AACL;;;;"}