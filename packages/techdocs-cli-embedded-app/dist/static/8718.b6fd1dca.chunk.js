"use strict";(()=>{var he=Object.defineProperty;var fe=(S,g,c)=>g in S?he(S,g,{enumerable:!0,configurable:!0,writable:!0,value:c}):S[g]=c;var k=(S,g,c)=>(fe(S,typeof g!="symbol"?g+"":g,c),c);(self.webpackChunktechdocs_cli_embedded_app=self.webpackChunktechdocs_cli_embedded_app||[]).push([[8718],{98718:function(S,g,c){c.r(g),c.d(g,{RealLogViewer:function(){return de}});var a=c(2784),U=c(10289),v=c(61837),W=c(19353),w=c(7688),D=c(50166),G=c(4903);const E=(0,G.Z)(),I=/\n\r?/g,b=Object.fromEntries(Object.entries({1:e=>({...e,bold:!0}),3:e=>({...e,italic:!0}),4:e=>({...e,underline:!0}),22:({bold:e,...t})=>t,23:({italic:e,...t})=>t,24:({underline:e,...t})=>t,30:e=>({...e,foreground:"black"}),31:e=>({...e,foreground:"red"}),32:e=>({...e,foreground:"green"}),33:e=>({...e,foreground:"yellow"}),34:e=>({...e,foreground:"blue"}),35:e=>({...e,foreground:"magenta"}),36:e=>({...e,foreground:"cyan"}),37:e=>({...e,foreground:"white"}),39:({foreground:e,...t})=>t,90:e=>({...e,foreground:"grey"}),40:e=>({...e,background:"black"}),41:e=>({...e,background:"red"}),42:e=>({...e,background:"green"}),43:e=>({...e,background:"yellow"}),44:e=>({...e,background:"blue"}),45:e=>({...e,background:"magenta"}),46:e=>({...e,background:"cyan"}),47:e=>({...e,background:"white"}),49:({background:e,...t})=>t}).map(([e,t])=>[`\x1B[${e}m`,t]));class L{constructor(t=1,n=[]){k(this,"text");this.lineNumber=t,this.chunks=n,this.text=n.map(s=>s.text).join("").toLocaleLowerCase("en-US")}lastChunk(){return this.chunks[this.chunks.length-1]}replaceLastChunk(t){t&&(this.chunks.splice(this.chunks.length-1,1,...t),this.text=this.chunks.map(n=>n.text).join("").toLocaleLowerCase("en-US"))}}class P{constructor(){k(this,"text","");k(this,"lines",[]);k(this,"processLines",(t,n={},s=1)=>{var l;const o=[];let i=n,r=s,u=0;for(I.lastIndex=0;;){const h=I.exec(t);if(!h){const f=this.processText(t.slice(u),i);return o.push(new L(r,f)),o}const d=t.slice(u,h.index);u=h.index+h[0].length;const p=this.processText(d,i);o.push(new L(r,p)),i=(l=p[p.length-1].modifiers)!=null?l:i,r+=1}});k(this,"processText",(t,n)=>{const s=[];let o=n,i=0;for(E.lastIndex=0;;){const r=E.exec(t);if(!r)return s.push({text:t.slice(i),modifiers:o}),s;const u=t.slice(i,r.index);s.push({text:u,modifiers:o}),i=r.index+r[0].length,o=this.processCode(r[0],o)}});k(this,"processCode",(t,n)=>{var s,o;return(o=(s=b[t])==null?void 0:s.call(b,n))!=null?o:n})}process(t){var n,s,o;if(this.text===t)return this.lines;if(t.startsWith(this.text)){const i=this.lines.length>0?this.lines.length-1:0,r=(n=this.lines[i])!=null?n:new L,u=r.lastChunk(),l=this.processLines(((s=u==null?void 0:u.text)!=null?s:"")+t.slice(this.text.length),u==null?void 0:u.modifiers,r==null?void 0:r.lineNumber);r.replaceLastChunk((o=l[0])==null?void 0:o.chunks),this.lines[i]=r,this.lines.push(...l.slice(1))}else this.lines=this.processLines(t);return this.text=t,this.lines}}var $=c(79692),B=c(41128),C=c(31754),F=c(66054),R=c(81463),M=c(34505),N=c(57186),T=c(32720),A=c(92901),j=c(45410);const z=40,Y=(0,$.Z)(e=>({root:{background:e.palette.background.paper},header:{height:z,display:"flex",alignItems:"center",justifyContent:"flex-end"},log:{fontFamily:'"Monaco", monospace',fontSize:e.typography.pxToRem(12)},line:{position:"relative",whiteSpace:"pre","&:hover":{background:e.palette.action.hover}},lineSelected:{background:e.palette.action.selected,"&:hover":{background:e.palette.action.selected}},lineCopyButton:{position:"absolute",paddingTop:0,paddingBottom:0},lineNumber:{display:"inline-block",textAlign:"end",width:60,marginRight:e.spacing(1),cursor:"pointer"},textHighlight:{background:(0,B.Fq)(e.palette.info.main,.15)},textSelectedHighlight:{background:(0,B.Fq)(e.palette.info.main,.4)},modifierBold:{fontWeight:e.typography.fontWeightBold},modifierItalic:{fontStyle:"italic"},modifierUnderline:{textDecoration:"underline"},modifierForegroundBlack:{color:C.Z.black},modifierForegroundRed:{color:F.Z[500]},modifierForegroundGreen:{color:R.Z[500]},modifierForegroundYellow:{color:M.Z[500]},modifierForegroundBlue:{color:N.Z[500]},modifierForegroundMagenta:{color:T.Z[500]},modifierForegroundCyan:{color:A.Z[500]},modifierForegroundWhite:{color:C.Z.white},modifierForegroundGrey:{color:j.Z[500]},modifierBackgroundBlack:{background:C.Z.black},modifierBackgroundRed:{background:F.Z[500]},modifierBackgroundGreen:{background:R.Z[500]},modifierBackgroundYellow:{background:M.Z[500]},modifierBackgroundBlue:{background:N.Z[500]},modifierBackgroundMagenta:{background:T.Z[500]},modifierBackgroundCyan:{background:A.Z[500]},modifierBackgroundWhite:{background:C.Z.white},modifierBackgroundGrey:{background:j.Z[500]}}),{name:"BackstageLogViewer"});var J=c(72779),K=c.n(J),Q=c(74600),H=c.n(Q);function X(e,t){const n=new Array;if(t.bold&&n.push(e.modifierBold),t.italic&&n.push(e.modifierItalic),t.underline&&n.push(e.modifierUnderline),t.foreground){const s=`modifierForeground${H()(t.foreground)}`;n.push(e[s])}if(t.background){const s=`modifierBackground${H()(t.background)}`;n.push(e[s])}return n.length>0?n.join(" "):void 0}function q(e,t){if(!t||!e.includes(t))return;const n=new Array;let s=0;for(;;){const o=e.indexOf(t,s);if(o===-1)break;const i=o+t.length;n.push({start:o,end:i}),s=i}return n}function _(e,t){const n=q(e.text,t);if(!n)return e.chunks;const s=new Array;let o=0,i=0,r=n[i];for(const u of e.chunks){const{text:l,modifiers:h}=u;if(!r||o+l.length<r.start){s.push(u),o+=l.length;continue}let d=0;for(;r;){const f=Math.max(r.start-o,0);if(f>l.length)break;const x=Math.min(r.end-o,l.length);if(f>d&&s.push({text:l.slice(d,f),modifiers:h}),x>f&&s.push({modifiers:h,highlight:i,text:l.slice(f,x)}),d=x,r.end-o===x)i+=1,r=n[i];else break}d<l.length&&s.push({text:l.slice(d),modifiers:h}),o+=l.length}return s}function ee({line:e,classes:t,searchText:n,highlightResultIndex:s}){const o=(0,a.useMemo)(()=>_(e,n),[e,n]),i=(0,a.useMemo)(()=>o.map(({text:r,modifiers:u,highlight:l},h)=>a.createElement("span",{key:h,className:K()(X(t,u),l!==void 0&&(l===s?t.textSelectedHighlight:t.textHighlight))},r)),[o,s,t]);return a.createElement(a.Fragment,null,i)}var te=c(86619),ne=c(90436),oe=c(48049),se=c(51209),O=c(36444);function re(e){var r;const{resultCount:t,resultIndexStep:n,toggleShouldFilter:s}=e,o=(r=e.resultIndex)!=null?r:0,i=u=>{u.key==="Enter"&&(u.metaKey||u.ctrlKey||u.altKey?s():n(u.shiftKey))};return a.createElement(a.Fragment,null,t!==void 0&&a.createElement(a.Fragment,null,a.createElement(v.Z,{size:"small",onClick:()=>n(!0)},a.createElement(oe.Z,null)),a.createElement(ne.Z,null,Math.min(o+1,t),"/",t),a.createElement(v.Z,{size:"small",onClick:()=>n()},a.createElement(se.Z,null))),a.createElement(te.Z,{size:"small",variant:"standard",placeholder:"Search",value:e.searchInput,onKeyPress:i,onChange:u=>e.setSearchInput(u.target.value)}),a.createElement(v.Z,{size:"small",onClick:s},e.shouldFilter?a.createElement(O.Z,{color:"primary"}):a.createElement(O.Z,{color:"disabled"})))}var le=c(3509);function ie(e,t){if(!t)return{lines:e};const n=[],s=[];for(const o of e)if(o.text.includes(t)){n.push(o);let i=0,r=0;for(;;){const u=o.text.indexOf(t,i);if(u===-1)break;s.push({lineNumber:o.lineNumber,lineIndex:r++}),i=u+t.length}}return{lines:n,results:s}}function ce(e){var f;const[t,n]=(0,a.useState)(""),s=t.toLocaleLowerCase("en-US"),[o,i]=(0,a.useState)(0),[r,u]=(0,le.O)(!1),l=(0,a.useMemo)(()=>ie(e,s),[e,s]),h=l.results?l.results[Math.min(o,l.results.length-1)]:void 0,d=(f=l.results)==null?void 0:f.length,p=x=>{if(x){if(d!==void 0){const m=Math.min(o-1,d-2);i(m<0?d-1:m)}}else if(d!==void 0){const m=o+1;i(m>=d?0:m)}};return{lines:r?l.lines:e,searchText:s,searchInput:t,setSearchInput:n,shouldFilter:r,toggleShouldFilter:u,resultCount:d,resultIndex:o,resultIndexStep:p,resultLine:h==null?void 0:h.lineNumber,resultLineIndex:h==null?void 0:h.lineIndex}}var V=c(36964),ae=c(95074);function ue(e){const t=(0,V.useApi)(V.errorApiRef),[n,s]=(0,a.useState)(),o=n?Math.min(n.start,n.end):void 0,i=n?Math.max(n.start,n.end):void 0,[{error:r},u]=(0,ae.Z)();return(0,a.useEffect)(()=>{r&&t.post(r)},[r,t]),{shouldShowButton(l){return o===l||i===l},isSelected(l){return n?o<=l&&l<=i:!1},setSelection(l,h){s(h?d=>d?{start:d.start,end:l}:{start:l,end:l}:d=>(d==null?void 0:d.start)===l&&(d==null?void 0:d.end)===l?void 0:{start:l,end:l})},copySelection(){if(n){const l=e.slice(Math.min(n.start,n.end)-1,Math.max(n.start,n.end)).map(h=>h.chunks.map(d=>d.text).join("")).join(`
`);u(l),s(void 0)}}}}function de(e){const t=Y({classes:e.classes}),n=(0,a.useRef)(null),o=(0,a.useMemo)(()=>new P,[]).process(e.text),i=ce(o),r=ue(o),u=(0,U.TH)();(0,a.useEffect)(()=>{i.resultLine!==void 0&&n.current&&n.current.scrollToItem(i.resultLine-1,"center")},[i.resultLine]),(0,a.useEffect)(()=>{if(u.hash){const h=parseInt(u.hash.replace(/\D/g,""),10);r.setSelection(h,!1)}},[]);const l=(h,d)=>{r.setSelection(h,d.shiftKey)};return a.createElement(w.Z,null,({height:h,width:d})=>a.createElement("div",{style:{width:d,height:h},className:t.root},a.createElement("div",{className:t.header},a.createElement(re,{...i})),a.createElement(D.t7,{ref:n,className:t.log,height:h-z,width:d,itemData:i.lines,itemSize:20,itemCount:i.lines.length},({index:p,style:f,data:x})=>{const m=x[p],{lineNumber:y}=m;return a.createElement("div",{style:{...f},className:K()(t.line,{[t.lineSelected]:r.isSelected(y)})},r.shouldShowButton(y)&&a.createElement(v.Z,{"data-testid":"copy-button",size:"small",className:t.lineCopyButton,onClick:()=>r.copySelection()},a.createElement(W.Z,{fontSize:"inherit"})),a.createElement("a",{role:"row",target:"_self",href:`#line-${y}`,className:t.lineNumber,onClick:Z=>l(y,Z),onKeyPress:Z=>l(y,Z)},y),a.createElement(ee,{line:m,classes:t,searchText:i.searchText,highlightResultIndex:i.resultLine===y?i.resultLineIndex:void 0}))})))}}}]);})();

//# sourceMappingURL=8718.b6fd1dca.chunk.js.map