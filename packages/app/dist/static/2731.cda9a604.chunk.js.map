{"version":3,"sources":["webpack://example-app/../node_modules/@sucrase/webpack-loader/dist/plugins/azure-devops/src/components/AzurePipelinesIcon/AzurePipelinesIcon.tsx","webpack://example-app/../node_modules/@sucrase/webpack-loader/dist/plugins/azure-devops/src/components/BuildTable/BuildTable.tsx","webpack://example-app/../node_modules/@sucrase/webpack-loader/dist/plugins/azure-devops/src/utils/getAnnotationFromEntity.ts","webpack://example-app/../node_modules/@sucrase/webpack-loader/dist/plugins/azure-devops/src/hooks/useBuildRuns.ts","webpack://example-app/../node_modules/@sucrase/webpack-loader/dist/plugins/azure-devops/src/components/EntityPageAzurePipelines/EntityPageAzurePipelines.tsx"],"names":[],"mappings":"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","file":"static/2731.cda9a604.chunk.js","sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SvgIcon, } from '@material-ui/core';\n\nimport React from 'react';\n\nexport const AzurePipelinesIcon = (props) => (\n  React.createElement(SvgIcon, { ...props, viewBox: \"0 0 512 512\"   ,}\n    , React.createElement('path', {\n      fill: \"none\",\n      stroke: \"currentColor\",\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeWidth: \"32\",\n      d: \"M461.81 53.81a4.4 4.4 0 00-3.3-3.39c-54.38-13.3-180 34.09-248.13 102.17a294.9 294.9 0 00-33.09 39.08c-21-1.9-42-.3-59.88 7.5-50.49 22.2-65.18 80.18-69.28 105.07a9 9 0 009.8 10.4l81.07-8.9a180.29 180.29 0 001.1 18.3 18.15 18.15 0 005.3 11.09l31.39 31.39a18.15 18.15 0 0011.1 5.3 179.91 179.91 0 0018.19 1.1l-8.89 81a9 9 0 0010.39 9.79c24.9-4 83-18.69 105.07-69.17 7.8-17.9 9.4-38.79 7.6-59.69a293.91 293.91 0 0039.19-33.09c68.38-68 115.47-190.86 102.37-247.95zM298.66 213.67a42.7 42.7 0 1160.38 0 42.65 42.65 0 01-60.38 0z\"                                                              ,}\n    )\n    , React.createElement('path', {\n      fill: \"none\",\n      stroke: \"currentColor\",\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeWidth: \"32\",\n      d: \"M109.64 352a45.06 45.06 0 00-26.35 12.84C65.67 382.52 64 448 64 448s65.52-1.67 83.15-19.31A44.73 44.73 0 00160 402.32\"               ,}\n    )\n  )\n);\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Box, Typography } from '@material-ui/core';\nimport {\n  BuildResult,\n\n  BuildStatus,\n} from '@backstage/plugin-azure-devops-common';\nimport {\n  Link,\n  ResponseErrorPanel,\n  StatusAborted,\n  StatusError,\n  StatusOK,\n  StatusPending,\n  StatusRunning,\n  StatusWarning,\n  Table,\n\n} from '@backstage/core-components';\n\nimport { AzurePipelinesIcon } from '../AzurePipelinesIcon';\nimport { DateTime } from 'luxon';\nimport React from 'react';\nimport { getDurationFromDates } from '../../utils/getDurationFromDates';\n\nexport const getBuildResultComponent = (result) => {\n  switch (result) {\n    case BuildResult.Succeeded:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusOK, null ), \" Succeeded\"\n        )\n      );\n    case BuildResult.PartiallySucceeded:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusWarning, null ), \" Partially Succeeded\"\n        )\n      );\n    case BuildResult.Failed:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusError, null ), \" Failed\"\n        )\n      );\n    case BuildResult.Canceled:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusAborted, null ), \" Canceled\"\n        )\n      );\n    case BuildResult.None:\n    default:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusWarning, null ), \" Unknown\"\n        )\n      );\n  }\n};\n\nexport const getBuildStateComponent = (\n  status,\n  result,\n) => {\n  switch (status) {\n    case BuildStatus.InProgress:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusRunning, null ), \" In Progress\"\n        )\n      );\n    case BuildStatus.Completed:\n      return getBuildResultComponent(result);\n    case BuildStatus.Cancelling:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusAborted, null ), \" Cancelling\"\n        )\n      );\n    case BuildStatus.Postponed:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusPending, null ), \" Postponed\"\n        )\n      );\n    case BuildStatus.NotStarted:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusAborted, null ), \" Not Started\"\n        )\n      );\n    case BuildStatus.None:\n    default:\n      return (\n        React.createElement('span', null\n          , React.createElement(StatusWarning, null ), \" Unknown\"\n        )\n      );\n  }\n};\n\nconst columns = [\n  {\n    title: 'ID',\n    field: 'id',\n    highlight: false,\n    width: 'auto',\n  },\n  {\n    title: 'Build',\n    field: 'title',\n    width: 'auto',\n    render: (row) => (\n      React.createElement(Link, { to: row.link || '',}, row.title)\n    ),\n  },\n  {\n    title: 'Source',\n    field: 'source',\n    width: 'auto',\n  },\n  {\n    title: 'State',\n    width: 'auto',\n    render: (row) => (\n      React.createElement(Box, { display: \"flex\", alignItems: \"center\",}\n        , React.createElement(Typography, { variant: \"button\",}\n          , getBuildStateComponent(row.status, row.result)\n        )\n      )\n    ),\n  },\n  {\n    title: 'Duration',\n    field: 'queueTime',\n    width: 'auto',\n    render: (row) => (\n      React.createElement(Box, { display: \"flex\", alignItems: \"center\",}\n        , React.createElement(Typography, null\n          , getDurationFromDates(row.startTime, row.finishTime)\n        )\n      )\n    ),\n  },\n  {\n    title: 'Age',\n    field: 'queueTime',\n    width: 'auto',\n    render: (row) =>\n      (row.queueTime\n        ? DateTime.fromISO(row.queueTime)\n        : DateTime.now()\n      ).toRelative(),\n  },\n];\n\n\n\n\n\n\n\nexport const BuildTable = ({ items, loading, error }) => {\n  if (error) {\n    return (\n      React.createElement('div', null\n        , React.createElement(ResponseErrorPanel, { error: error,} )\n      )\n    );\n  }\n\n  return (\n    React.createElement(Table, {\n      isLoading: loading,\n      columns: columns,\n      options: {\n        search: true,\n        paging: true,\n        pageSize: 5,\n        showEmptyDataSourceMessage: !loading,\n      },\n      title: \n        React.createElement(Box, { display: \"flex\", alignItems: \"center\",}\n          , React.createElement(AzurePipelinesIcon, { style: { fontSize: 30 },} )\n          , React.createElement(Box, { mr: 1,} ), \"Azure Pipelines - Builds (\"\n              , items ? items.length : 0, \")\"\n        )\n      ,\n      data: items ?? [],}\n    )\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  AZURE_DEVOPS_BUILD_DEFINITION_ANNOTATION,\n  AZURE_DEVOPS_PROJECT_ANNOTATION,\n  AZURE_DEVOPS_REPO_ANNOTATION,\n} from '../constants';\n\n\n\nexport function getAnnotationFromEntity(entity)\n\n\n\n {\n  const annotation =\n    entity.metadata.annotations?.[AZURE_DEVOPS_REPO_ANNOTATION];\n  if (annotation) {\n    const { project, repo } = getProjectRepo(annotation);\n    const definition = undefined;\n    return { project, repo, definition };\n  }\n\n  const project =\n    entity.metadata.annotations?.[AZURE_DEVOPS_PROJECT_ANNOTATION];\n  if (!project) {\n    throw new Error('Value for annotation dev.azure.com/project was not found');\n  }\n\n  const definition =\n    entity.metadata.annotations?.[AZURE_DEVOPS_BUILD_DEFINITION_ANNOTATION];\n  if (!definition) {\n    throw new Error(\n      'Value for annotation dev.azure.com/build-definition was not found',\n    );\n  }\n\n  const repo = undefined;\n  return { project, repo, definition };\n}\n\nfunction getProjectRepo(annotation)\n\n\n {\n  const [project, repo] = annotation.split('/');\n\n  if (!project && !repo) {\n    throw new Error(\n      'Value for annotation dev.azure.com/project-repo was not in the correct format: <project-name>/<repo-name>',\n    );\n  }\n\n  return { project, repo };\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { AZURE_DEVOPS_DEFAULT_TOP } from '../constants';\nimport { azureDevOpsApiRef } from '../api';\nimport { useApi } from '@backstage/core-plugin-api';\nimport useAsync from 'react-use/lib/useAsync';\n\nexport function useBuildRuns(\n  projectName,\n  defaultLimit,\n  repoName,\n  definitionName,\n)\n\n\n\n {\n  const top = defaultLimit ?? AZURE_DEVOPS_DEFAULT_TOP;\n  const options = {\n    top: top,\n  };\n\n  const api = useApi(azureDevOpsApiRef);\n\n  const { value, loading, error } = useAsync(() => {\n    return api.getBuildRuns(projectName, repoName, definitionName, options);\n  }, [api, projectName, repoName, definitionName]);\n\n  return {\n    items: value?.items,\n    loading,\n    error,\n  };\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BuildTable } from '../BuildTable/BuildTable';\nimport React from 'react';\nimport { getAnnotationFromEntity } from '../../utils/getAnnotationFromEntity';\nimport { useBuildRuns } from '../../hooks/useBuildRuns';\nimport { useEntity } from '@backstage/plugin-catalog-react';\n\nexport const EntityPageAzurePipelines = ({\n  defaultLimit,\n}\n\n) => {\n  const { entity } = useEntity();\n\n  const { project, repo, definition } = getAnnotationFromEntity(entity);\n\n  const { items, loading, error } = useBuildRuns(\n    project,\n    defaultLimit,\n    repo,\n    definition,\n  );\n\n  return React.createElement(BuildTable, { items: items, loading: loading, error: error,} );\n};\n"],"sourceRoot":""}