{"version":3,"file":"index.cjs.js","sources":["../src/lib/helpers.ts","../src/commands/run.ts","../src/commands/index.ts","../src/index.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assertError } from '@backstage/errors';\nimport {\n  spawn,\n  execFile as execFileCb,\n  SpawnOptions,\n  ChildProcess,\n} from 'child_process';\nimport { promisify } from 'util';\nimport puppeteer from 'puppeteer';\n\nconst execFile = promisify(execFileCb);\n\nexport function spawnPiped(cmd: string[], options?: SpawnOptions) {\n  function pipeWithPrefix(stream: NodeJS.WriteStream, prefix = '') {\n    return (data: Buffer) => {\n      const prefixedMsg = data\n        .toString('utf8')\n        .trimRight()\n        .replace(/^/gm, prefix);\n      stream.write(`${prefixedMsg}\\n`, 'utf8');\n    };\n  }\n\n  const child = spawn(cmd[0], cmd.slice(1), {\n    stdio: 'pipe',\n    shell: true,\n    ...options,\n  });\n  child.on('error', exitWithError);\n\n  const logPrefix = cmd.map(s => s.replace(/.+\\//, '')).join(' ');\n  child.stdout?.on(\n    'data',\n    pipeWithPrefix(process.stdout, `[${logPrefix}].out: `),\n  );\n  child.stderr?.on(\n    'data',\n    pipeWithPrefix(process.stderr, `[${logPrefix}].err: `),\n  );\n\n  return child;\n}\n\nexport async function runPlain(cmd: string[], options?: SpawnOptions) {\n  try {\n    const { stdout } = await execFile(cmd[0], cmd.slice(1), {\n      ...options,\n      shell: true,\n    });\n    return stdout.trim();\n  } catch (error) {\n    assertError(error);\n    if (error.stdout) {\n      process.stdout.write(error.stdout as Buffer);\n    }\n    if (error.stderr) {\n      process.stderr.write(error.stderr as Buffer);\n    }\n    throw error;\n  }\n}\n\nexport function exitWithError(err: Error & { code?: unknown }) {\n  process.stdout.write(`${err.name}: ${err.stack || err.message}\\n`);\n\n  if (typeof err.code === 'number') {\n    process.exit(err.code);\n  } else {\n    process.exit(1);\n  }\n}\n\n/**\n * Waits for fn() to be true\n * Checks every 100ms\n * .cancel() is available\n * @returns Promise of resolution\n */\nexport function waitFor(fn: () => boolean, maxSeconds: number = 120) {\n  let count = 0;\n  return new Promise<void>((resolve, reject) => {\n    const handle = setInterval(() => {\n      if (count++ > maxSeconds * 10) {\n        reject(new Error('Timed out while waiting for condition'));\n        return;\n      }\n      if (fn()) {\n        clearInterval(handle);\n        resolve();\n        return;\n      }\n    }, 100);\n  });\n}\n\nexport async function waitForExit(child: ChildProcess) {\n  if (child.exitCode !== null) {\n    throw new Error(`Child already exited with code ${child.exitCode}`);\n  }\n  await new Promise<void>((resolve, reject) =>\n    child.once('exit', code => {\n      if (code) {\n        reject(new Error(`Child exited with code ${code}`));\n      } else {\n        print('Child finished');\n        resolve();\n      }\n    }),\n  );\n}\n\nexport async function waitForPageWithText(\n  page: puppeteer.Page,\n  path: string,\n  text: string,\n  { intervalMs = 1000, maxFindAttempts = 50 } = {},\n) {\n  let findAttempts = 0;\n  for (;;) {\n    try {\n      const waitTimeMs = intervalMs * (findAttempts + 1);\n      console.log(`Attempting to load page at ${path}, waiting ${waitTimeMs}`);\n      await new Promise(resolve => setTimeout(resolve, waitTimeMs));\n\n      await page.goto(`http://localhost:3000${path}`, {\n        waitUntil: 'networkidle0',\n      });\n\n      const match = await page.evaluate(\n        textContent =>\n          Array.from(document.querySelectorAll('*')).some(\n            el => el.textContent === textContent,\n          ),\n        text,\n      );\n\n      if (!match) {\n        throw new Error(`Expected to find text ${text}`);\n      }\n\n      break;\n    } catch (error) {\n      console.log(error);\n      assertError(error);\n\n      findAttempts++;\n      if (findAttempts >= maxFindAttempts) {\n        throw new Error(\n          `Failed to load page '${path}', max number of attempts reached`,\n        );\n      }\n    }\n  }\n}\n\nexport function print(msg: string) {\n  return process.stdout.write(`${msg}\\n`);\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport os from 'os';\nimport fs from 'fs-extra';\nimport fetch from 'cross-fetch';\nimport handlebars from 'handlebars';\nimport killTree from 'tree-kill';\nimport { resolve as resolvePath, join as joinPath } from 'path';\nimport puppeteer from 'puppeteer';\nimport path from 'path';\n\nimport {\n  spawnPiped,\n  runPlain,\n  waitForPageWithText,\n  waitFor,\n  waitForExit,\n  print,\n} from '../lib/helpers';\nimport pgtools from 'pgtools';\nimport { findPaths } from '@backstage/cli-common';\n\n// eslint-disable-next-line no-restricted-syntax\nconst paths = findPaths(__dirname);\n\nconst templatePackagePaths = [\n  'packages/cli/templates/default-plugin/package.json.hbs',\n  'packages/create-app/templates/default-app/packages/app/package.json.hbs',\n  'packages/create-app/templates/default-app/packages/backend/package.json.hbs',\n];\n\nexport async function run() {\n  const rootDir = await fs.mkdtemp(resolvePath(os.tmpdir(), 'backstage-e2e-'));\n  print(`CLI E2E test root: ${rootDir}\\n`);\n\n  print('Building dist workspace');\n  const workspaceDir = await buildDistWorkspace('workspace', rootDir);\n\n  print('Creating a Backstage App');\n  const appDir = await createApp('test-app', workspaceDir, rootDir);\n\n  print('Creating a Backstage Plugin');\n  const pluginName = await createPlugin('test-plugin', appDir);\n\n  print('Creating a Backstage Backend Plugin');\n  await createPlugin('test-plugin', appDir, ['--backend']);\n\n  print('Starting the app');\n  await testAppServe(pluginName, appDir);\n\n  if (Boolean(process.env.POSTGRES_USER)) {\n    print('Testing the PostgreSQL backend startup');\n    await preCleanPostgres();\n    const appConfig = path.resolve(appDir, 'app-config.yaml');\n    const productionConfig = path.resolve(appDir, 'app-config.production.yaml');\n    await testBackendStart(\n      appDir,\n      '--config',\n      appConfig,\n      '--config',\n      productionConfig,\n    );\n  }\n  print('Testing the SQLite backend startup');\n  await testBackendStart(appDir);\n\n  if (process.env.CI) {\n    // Cleanup actually takes significant time, so skip it in CI since the\n    // runner will be destroyed anyway\n    print('All tests successful');\n  } else {\n    print('All tests successful, removing test dir');\n    await fs.remove(rootDir);\n  }\n\n  // Just in case some child process was left hanging\n  process.exit(0);\n}\n\n/**\n * Builds a dist workspace that contains the cli and core packages\n */\nasync function buildDistWorkspace(workspaceName: string, rootDir: string) {\n  const workspaceDir = resolvePath(rootDir, workspaceName);\n  await fs.ensureDir(workspaceDir);\n\n  // We grab the needed dependencies from the create app template\n  const createAppDeps = new Set<string>();\n\n  function appendDeps(pkg: any) {\n    Array<string>()\n      .concat(\n        Object.keys(pkg.dependencies ?? {}),\n        Object.keys(pkg.devDependencies ?? {}),\n        Object.keys(pkg.peerDependencies ?? {}),\n      )\n      .filter(name => name.startsWith('@backstage/'))\n      .forEach(dep => createAppDeps.add(dep));\n  }\n\n  for (const pkgJsonPath of templatePackagePaths) {\n    const jsonPath = paths.resolveOwnRoot(pkgJsonPath);\n    const pkgTemplate = await fs.readFile(jsonPath, 'utf8');\n    const pkg = JSON.parse(\n      handlebars.compile(pkgTemplate)(\n        {\n          privatePackage: true,\n          scopeName: '@backstage',\n        },\n        {\n          helpers: {\n            version(name: string) {\n              // Ignore non Backstage packages\n              if (!name.startsWith('@backstage/')) {\n                return '^0.0.0';\n              }\n              const pkge = require(`${name}/package.json`);\n              if (!pkge) {\n                throw new Error(`No version available for package ${name}`);\n              }\n              return pkge.version;\n            },\n            versionQuery(name: string, hint: string) {\n              // Ignore non Backstage packages\n              if (!name.startsWith('@backstage/')) {\n                return '^0.0.0';\n              }\n              const pkgData = require(`${name}/package.json`);\n              if (!pkgData) {\n                if (typeof hint !== 'string') {\n                  throw new Error(`No version available for package ${name}`);\n                }\n                return `^${hint}`;\n              }\n              return `^${pkgData.version}`;\n            },\n          },\n        },\n      ),\n    );\n    appendDeps(pkg);\n  }\n\n  // eslint-disable-next-line import/no-extraneous-dependencies\n  appendDeps(require('@backstage/create-app/package.json'));\n\n  print(`Preparing workspace`);\n  await runPlain([\n    'yarn',\n    'backstage-cli',\n    'build-workspace',\n    workspaceDir,\n    '@backstage/create-app',\n    ...createAppDeps,\n  ]);\n\n  print('Pinning yarn version in workspace');\n  await pinYarnVersion(workspaceDir);\n\n  print('Installing workspace dependencies');\n  await runPlain(['yarn', 'install', '--production', '--frozen-lockfile'], {\n    cwd: workspaceDir,\n  });\n\n  return workspaceDir;\n}\n\n/**\n * Pin the yarn version in a directory to the one we're using in the Backstage repo\n */\nasync function pinYarnVersion(dir: string) {\n  const yarnRc = await fs.readFile(paths.resolveOwnRoot('.yarnrc'), 'utf8');\n  const yarnRcLines = yarnRc.split('\\n');\n  const yarnPathLine = yarnRcLines.find(line => line.startsWith('yarn-path'));\n  if (!yarnPathLine) {\n    throw new Error(`Unable to find 'yarn-path' in ${yarnRc}`);\n  }\n  const match = yarnPathLine.match(/\"(.*)\"/);\n  if (!match) {\n    throw new Error(`Invalid 'yarn-path' in ${yarnRc}`);\n  }\n  const [, localYarnPath] = match;\n  const yarnPath = paths.resolveOwnRoot(localYarnPath);\n\n  await fs.writeFile(resolvePath(dir, '.yarnrc'), `yarn-path \"${yarnPath}\"\\n`);\n}\n\n/**\n * Creates a new app inside rootDir called test-app, using packages from the workspaceDir\n */\nasync function createApp(\n  appName: string,\n  workspaceDir: string,\n  rootDir: string,\n) {\n  const child = spawnPiped(\n    [\n      'node',\n      resolvePath(workspaceDir, 'packages/create-app/bin/backstage-create-app'),\n      '--skip-install',\n    ],\n    {\n      cwd: rootDir,\n    },\n  );\n\n  try {\n    let stdout = '';\n    child.stdout?.on('data', data => {\n      stdout = stdout + data.toString('utf8');\n    });\n\n    await waitFor(() => stdout.includes('Enter a name for the app'));\n    child.stdin?.write(`${appName}\\n`);\n\n    print('Waiting for app create script to be done');\n    await waitForExit(child);\n\n    const appDir = resolvePath(rootDir, appName);\n\n    print('Rewriting module resolutions of app to use workspace packages');\n    await overrideModuleResolutions(appDir, workspaceDir);\n\n    print('Pinning yarn version and registry in app');\n    await pinYarnVersion(appDir);\n    await fs.writeFile(\n      resolvePath(appDir, '.npmrc'),\n      'registry=https://registry.npmjs.org/\\n',\n    );\n\n    print('Test app created');\n\n    for (const cmd of [\n      'install',\n      'tsc:full',\n      'build',\n      'lint:all',\n      'prettier:check',\n      'test:all',\n    ]) {\n      print(`Running 'yarn ${cmd}' in newly created app`);\n      await runPlain(['yarn', cmd], { cwd: appDir });\n    }\n\n    print(`Running 'yarn test:e2e:ci' in newly created app`);\n    await runPlain(['yarn', 'test:e2e:ci'], {\n      cwd: resolvePath(appDir, 'packages', 'app'),\n      env: {\n        ...process.env,\n        APP_CONFIG_app_baseUrl: '\"http://localhost:3001\"',\n      },\n    });\n\n    return appDir;\n  } finally {\n    child.kill();\n  }\n}\n\n/**\n * This points dependency resolutions into the workspace for each package that is present there\n */\nasync function overrideModuleResolutions(appDir: string, workspaceDir: string) {\n  const pkgJsonPath = resolvePath(appDir, 'package.json');\n  const pkgJson = await fs.readJson(pkgJsonPath);\n\n  pkgJson.resolutions = pkgJson.resolutions || {};\n  pkgJson.dependencies = pkgJson.dependencies || {};\n\n  for (const dir of ['packages', 'plugins']) {\n    const packageNames = await fs.readdir(resolvePath(workspaceDir, dir));\n    for (const pkgDir of packageNames) {\n      const pkgPath = joinPath('..', 'workspace', dir, pkgDir);\n      const { name } = await fs.readJson(\n        resolvePath(workspaceDir, dir, pkgDir, 'package.json'),\n      );\n\n      pkgJson.dependencies[name] = `file:${pkgPath}`;\n      pkgJson.resolutions[name] = `file:${pkgPath}`;\n      delete pkgJson.devDependencies[name];\n    }\n  }\n  fs.writeJson(pkgJsonPath, pkgJson, { spaces: 2 });\n}\n\n/**\n * Uses create-plugin command to create a new plugin in the app\n */\nasync function createPlugin(\n  pluginName: string,\n  appDir: string,\n  options: string[] = [],\n) {\n  const child = spawnPiped(['yarn', 'create-plugin', ...options], {\n    cwd: appDir,\n  });\n\n  try {\n    let stdout = '';\n    child.stdout?.on('data', (data: Buffer) => {\n      stdout = stdout + data.toString('utf8');\n    });\n\n    await waitFor(() => stdout.includes('Enter an ID for the plugin'));\n    child.stdin?.write(`${pluginName}\\n`);\n\n    // await waitFor(() => stdout.includes('Enter the owner(s) of the plugin'));\n    // child.stdin.write('@someuser\\n');\n\n    print('Waiting for plugin create script to be done');\n    await waitForExit(child);\n\n    const canonicalName = options.includes('--backend')\n      ? `${pluginName}-backend`\n      : pluginName;\n\n    const pluginDir = resolvePath(appDir, 'plugins', canonicalName);\n\n    for (const cmd of [['tsc'], ['lint'], ['test', '--no-watch']]) {\n      print(`Running 'yarn ${cmd.join(' ')}' in newly created plugin`);\n      await runPlain(['yarn', ...cmd], { cwd: pluginDir });\n    }\n\n    return canonicalName;\n  } finally {\n    child.kill();\n  }\n}\n\n/**\n * Start serving the newly created app and make sure that the create plugin is rendering correctly\n */\nasync function testAppServe(pluginName: string, appDir: string) {\n  const startApp = spawnPiped(['yarn', 'start'], {\n    cwd: appDir,\n    env: {\n      ...process.env,\n      GITHUB_TOKEN: 'abc',\n    },\n  });\n\n  let successful = false;\n\n  let browser;\n  try {\n    for (let attempts = 1; ; attempts++) {\n      try {\n        browser = await puppeteer.launch();\n        const page = await browser.newPage();\n\n        await page.goto('http://localhost:3000', { waitUntil: 'networkidle0' });\n\n        await waitForPageWithText(page, '/', 'My Company Catalog');\n        await waitForPageWithText(\n          page,\n          `/${pluginName}`,\n          `Welcome to ${pluginName}!`,\n        );\n\n        print('Both App and Plugin loaded correctly');\n        successful = true;\n        break;\n      } catch (error) {\n        if (attempts >= 20) {\n          throw new Error(`App serve test failed, ${error}`);\n        }\n        print(`App serve failed, trying again, ${error}`);\n        await new Promise(resolve => setTimeout(resolve, 1000));\n      }\n    }\n  } finally {\n    // Kill entire process group, otherwise we'll end up with hanging serve processes\n    await new Promise<void>((res, rej) => {\n      killTree(startApp.pid!, err => (err ? rej(err) : res()));\n    });\n  }\n\n  try {\n    await waitForExit(startApp);\n  } catch (error) {\n    if (!successful) {\n      throw error;\n    }\n  }\n}\n\n/** Drops PG databases */\nasync function dropDB(database: string) {\n  const config = {\n    host: process.env.POSTGRES_HOST,\n    port: process.env.POSTGRES_PORT,\n    user: process.env.POSTGRES_USER,\n    password: process.env.POSTGRES_PASSWORD,\n  };\n\n  try {\n    await pgtools.dropdb(config, database);\n  } catch (_) {\n    /* do nothing*/\n  }\n}\n\n/** Clean remnants from prior e2e runs */\nasync function preCleanPostgres() {\n  print('Dropping old DBs');\n  await Promise.all(\n    [\n      'catalog',\n      'scaffolder',\n      'auth',\n      'identity',\n      'proxy',\n      'techdocs',\n      'search',\n    ].map(name => dropDB(`backstage_plugin_${name}`)),\n  );\n  print('Created DBs');\n}\n\n/**\n * Start serving the newly created backend and make sure that all db migrations works correctly\n */\nasync function testBackendStart(appDir: string, ...args: string[]) {\n  const child = spawnPiped(['yarn', 'workspace', 'backend', 'start', ...args], {\n    cwd: appDir,\n    env: {\n      ...process.env,\n      GITHUB_TOKEN: 'abc',\n    },\n  });\n\n  let stdout = '';\n  let stderr = '';\n  child.stdout?.on('data', (data: Buffer) => {\n    stdout = stdout + data.toString('utf8');\n  });\n  child.stderr?.on('data', (data: Buffer) => {\n    stderr = stderr + data.toString('utf8');\n  });\n  let successful = false;\n\n  const stdErrorHasErrors = (input: string) => {\n    const lines = input.split('\\n').filter(Boolean);\n    return (\n      lines.filter(\n        l =>\n          !l.includes('Use of deprecated folder mapping') &&\n          !l.includes('Update this package.json to use a subpath') &&\n          !l.includes(\n            '(Use `node --trace-deprecation ...` to show where the warning was created)',\n          ),\n      ).length !== 0\n    );\n  };\n\n  try {\n    await waitFor(\n      () => stdout.includes('Listening on ') || stdErrorHasErrors(stderr),\n    );\n    if (stdErrorHasErrors(stderr)) {\n      print(`Expected stderr to be clean, got ${stderr}`);\n      // Skipping the whole block\n      throw new Error(stderr);\n    }\n\n    print('Try to fetch entities from the backend');\n    // Try fetch entities, should be ok\n    await fetch('http://localhost:7007/api/catalog/entities').then(res =>\n      res.json(),\n    );\n    print('Entities fetched successfully');\n    successful = true;\n  } catch (error) {\n    print('');\n    throw new Error(`Backend failed to startup: ${error}`);\n  } finally {\n    print('Stopping the child process');\n    // Kill entire process group, otherwise we'll end up with hanging serve processes\n    await new Promise<void>((res, rej) => {\n      killTree(child.pid!, err => (err ? rej(err) : res()));\n    });\n  }\n\n  try {\n    await waitForExit(child);\n  } catch (error) {\n    if (!successful) {\n      throw new Error(`Backend failed to startup: ${stderr}`);\n    }\n    print('Backend startup test finished successfully');\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Command } from 'commander';\nimport { run } from './run';\n\nexport function registerCommands(program: Command) {\n  program.command('run').description('Run e2e tests').action(run);\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { program } from 'commander';\nimport chalk from 'chalk';\nimport { registerCommands } from './commands';\nimport { version } from '../package.json';\nimport { exitWithError } from './lib/helpers';\n\nasync function main(argv: string[]) {\n  program.name('e2e-test').version(version);\n\n  registerCommands(program);\n\n  program.on('command:*', () => {\n    console.log();\n    console.log(chalk.red(`Invalid command: ${program.args.join(' ')}`));\n    console.log();\n    program.outputHelp();\n    process.exit(1);\n  });\n\n  program.parse(argv);\n}\n\nprocess.on('unhandledRejection', (rejection: unknown) => {\n  // Try to avoid exiting if the unhandled error is coming from jsdom, i.e. zombie.\n  // Those are typically errors on the page that should be benign, at least in the\n  // context of this test. We have other ways of asserting that the page is being\n  // rendered correctly.\n  if (\n    rejection instanceof Error &&\n    rejection?.stack?.includes('node_modules/jsdom/lib')\n  ) {\n    console.log(`Ignored error inside jsdom, ${rejection?.stack ?? rejection}`);\n  } else {\n    if (rejection instanceof Error) {\n      exitWithError(rejection);\n    } else {\n      exitWithError(new Error(`Unknown rejection: '${rejection}'`));\n    }\n  }\n});\n\nmain(process.argv).catch(exitWithError);\n"],"names":["promisify","execFileCb","spawn","assertError","findPaths","fs","resolvePath","os","path","handlebars","joinPath","puppeteer","killTree","pgtools","fetch","program","chalk"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,MAAM,QAAQ,GAAGA,cAAS,CAACC,sBAAU,CAAC,CAAC;AAChC,SAAS,UAAU,CAAC,GAAG,EAAE,OAAO,EAAE;AACzC,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACb,EAAE,SAAS,cAAc,CAAC,MAAM,EAAE,MAAM,GAAG,EAAE,EAAE;AAC/C,IAAI,OAAO,CAAC,IAAI,KAAK;AACrB,MAAM,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AACnF,MAAM,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,WAAW,CAAC;AAClC,CAAC,EAAE,MAAM,CAAC,CAAC;AACX,KAAK,CAAC;AACN,GAAG;AACH,EAAE,MAAM,KAAK,GAAGC,mBAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;AAC5C,IAAI,KAAK,EAAE,MAAM;AACjB,IAAI,KAAK,EAAE,IAAI;AACf,IAAI,GAAG,OAAO;AACd,GAAG,CAAC,CAAC;AACL,EAAE,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;AACnC,EAAE,MAAM,SAAS,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AACpE,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,MAAM,EAAE,cAAc,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,EAAE,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;AAC/G,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,MAAM,EAAE,cAAc,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,EAAE,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;AAC/G,EAAE,OAAO,KAAK,CAAC;AACf,CAAC;AACM,eAAe,QAAQ,CAAC,GAAG,EAAE,OAAO,EAAE;AAC7C,EAAE,IAAI;AACN,IAAI,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;AAC5D,MAAM,GAAG,OAAO;AAChB,MAAM,KAAK,EAAE,IAAI;AACjB,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,MAAM,CAAC,IAAI,EAAE,CAAC;AACzB,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAIC,kBAAW,CAAC,KAAK,CAAC,CAAC;AACvB,IAAI,IAAI,KAAK,CAAC,MAAM,EAAE;AACtB,MAAM,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;AACzC,KAAK;AACL,IAAI,IAAI,KAAK,CAAC,MAAM,EAAE;AACtB,MAAM,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;AACzC,KAAK;AACL,IAAI,MAAM,KAAK,CAAC;AAChB,GAAG;AACH,CAAC;AACM,SAAS,aAAa,CAAC,GAAG,EAAE;AACnC,EAAE,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,OAAO,CAAC;AAChE,CAAC,CAAC,CAAC;AACH,EAAE,IAAI,OAAO,GAAG,CAAC,IAAI,KAAK,QAAQ,EAAE;AACpC,IAAI,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAC3B,GAAG,MAAM;AACT,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACpB,GAAG;AACH,CAAC;AACM,SAAS,OAAO,CAAC,EAAE,EAAE,UAAU,GAAG,GAAG,EAAE;AAC9C,EAAE,IAAI,KAAK,GAAG,CAAC,CAAC;AAChB,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK;AAC1C,IAAI,MAAM,MAAM,GAAG,WAAW,CAAC,MAAM;AACrC,MAAM,IAAI,KAAK,EAAE,GAAG,UAAU,GAAG,EAAE,EAAE;AACrC,QAAQ,MAAM,CAAC,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC,CAAC;AACnE,QAAQ,OAAO;AACf,OAAO;AACP,MAAM,IAAI,EAAE,EAAE,EAAE;AAChB,QAAQ,aAAa,CAAC,MAAM,CAAC,CAAC;AAC9B,QAAQ,OAAO,EAAE,CAAC;AAClB,QAAQ,OAAO;AACf,OAAO;AACP,KAAK,EAAE,GAAG,CAAC,CAAC;AACZ,GAAG,CAAC,CAAC;AACL,CAAC;AACM,eAAe,WAAW,CAAC,KAAK,EAAE;AACzC,EAAE,IAAI,KAAK,CAAC,QAAQ,KAAK,IAAI,EAAE;AAC/B,IAAI,MAAM,IAAI,KAAK,CAAC,CAAC,+BAA+B,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;AACxE,GAAG;AACH,EAAE,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAK,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,IAAI,KAAK;AACtE,IAAI,IAAI,IAAI,EAAE;AACd,MAAM,MAAM,CAAC,IAAI,KAAK,CAAC,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AAC1D,KAAK,MAAM;AACX,MAAM,KAAK,CAAC,gBAAgB,CAAC,CAAC;AAC9B,MAAM,OAAO,EAAE,CAAC;AAChB,KAAK;AACL,GAAG,CAAC,CAAC,CAAC;AACN,CAAC;AACM,eAAe,mBAAmB,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,UAAU,GAAG,GAAG,EAAE,eAAe,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE;AAC7G,EAAE,IAAI,YAAY,GAAG,CAAC,CAAC;AACvB,EAAE,WAAW;AACb,IAAI,IAAI;AACR,MAAM,MAAM,UAAU,GAAG,UAAU,IAAI,YAAY,GAAG,CAAC,CAAC,CAAC;AACzD,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,2BAA2B,EAAE,IAAI,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;AAC/E,MAAM,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,UAAU,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC;AACtE,MAAM,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,qBAAqB,EAAE,IAAI,CAAC,CAAC,EAAE;AACtD,QAAQ,SAAS,EAAE,cAAc;AACjC,OAAO,CAAC,CAAC;AACT,MAAM,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,CAAC,WAAW,KAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,WAAW,KAAK,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC;AACxJ,MAAM,IAAI,CAAC,KAAK,EAAE;AAClB,QAAQ,MAAM,IAAI,KAAK,CAAC,CAAC,sBAAsB,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AACzD,OAAO;AACP,MAAM,MAAM;AACZ,KAAK,CAAC,OAAO,KAAK,EAAE;AACpB,MAAM,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;AACzB,MAAMA,kBAAW,CAAC,KAAK,CAAC,CAAC;AACzB,MAAM,YAAY,EAAE,CAAC;AACrB,MAAM,IAAI,YAAY,IAAI,eAAe,EAAE;AAC3C,QAAQ,MAAM,IAAI,KAAK,CAAC,CAAC,qBAAqB,EAAE,IAAI,CAAC,iCAAiC,CAAC,CAAC,CAAC;AACzF,OAAO;AACP,KAAK;AACL,GAAG;AACH,CAAC;AACM,SAAS,KAAK,CAAC,GAAG,EAAE;AAC3B,EAAE,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC;AACrC,CAAC,CAAC,CAAC;AACH;;AC7FA,MAAM,KAAK,GAAGC,mBAAS,CAAC,SAAS,CAAC,CAAC;AACnC,MAAM,oBAAoB,GAAG;AAC7B,EAAE,wDAAwD;AAC1D,EAAE,yEAAyE;AAC3E,EAAE,6EAA6E;AAC/E,CAAC,CAAC;AACK,eAAe,GAAG,GAAG;AAC5B,EAAE,MAAM,OAAO,GAAG,MAAMC,sBAAE,CAAC,OAAO,CAACC,YAAW,CAACC,sBAAE,CAAC,MAAM,EAAE,EAAE,gBAAgB,CAAC,CAAC,CAAC;AAC/E,EAAE,KAAK,CAAC,CAAC,mBAAmB,EAAE,OAAO,CAAC;AACtC,CAAC,CAAC,CAAC;AACH,EAAE,KAAK,CAAC,yBAAyB,CAAC,CAAC;AACnC,EAAE,MAAM,YAAY,GAAG,MAAM,kBAAkB,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;AACtE,EAAE,KAAK,CAAC,0BAA0B,CAAC,CAAC;AACpC,EAAE,MAAM,MAAM,GAAG,MAAM,SAAS,CAAC,UAAU,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;AACpE,EAAE,KAAK,CAAC,6BAA6B,CAAC,CAAC;AACvC,EAAE,MAAM,UAAU,GAAG,MAAM,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;AAC/D,EAAE,KAAK,CAAC,qCAAqC,CAAC,CAAC;AAC/C,EAAE,MAAM,YAAY,CAAC,aAAa,EAAE,MAAM,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;AAC3D,EAAE,KAAK,CAAC,kBAAkB,CAAC,CAAC;AAC5B,EAAE,MAAM,YAAY,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;AACzC,EAAE,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE;AAC1C,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC;AACpD,IAAI,MAAM,gBAAgB,EAAE,CAAC;AAC7B,IAAI,MAAM,SAAS,GAAGC,wBAAI,CAAC,OAAO,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC;AAC9D,IAAI,MAAM,gBAAgB,GAAGA,wBAAI,CAAC,OAAO,CAAC,MAAM,EAAE,4BAA4B,CAAC,CAAC;AAChF,IAAI,MAAM,gBAAgB,CAAC,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,UAAU,EAAE,gBAAgB,CAAC,CAAC;AACxF,GAAG;AACH,EAAE,KAAK,CAAC,oCAAoC,CAAC,CAAC;AAC9C,EAAE,MAAM,gBAAgB,CAAC,MAAM,CAAC,CAAC;AACjC,EAAE,IAAI,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE;AACtB,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;AAClC,GAAG,MAAM;AACT,IAAI,KAAK,CAAC,yCAAyC,CAAC,CAAC;AACrD,IAAI,MAAMH,sBAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AAC7B,GAAG;AACH,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAClB,CAAC;AACD,eAAe,kBAAkB,CAAC,aAAa,EAAE,OAAO,EAAE;AAC1D,EAAE,MAAM,YAAY,GAAGC,YAAW,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;AAC3D,EAAE,MAAMD,sBAAE,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;AACnC,EAAE,MAAM,aAAa,mBAAmB,IAAI,GAAG,EAAE,CAAC;AAClD,EAAE,SAAS,UAAU,CAAC,GAAG,EAAE;AAC3B,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;AACnB,IAAI,KAAK,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,YAAY,KAAK,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,eAAe,KAAK,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,GAAG,CAAC,gBAAgB,KAAK,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AAC5R,GAAG;AACH,EAAE,KAAK,MAAM,WAAW,IAAI,oBAAoB,EAAE;AAClD,IAAI,MAAM,QAAQ,GAAG,KAAK,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;AACvD,IAAI,MAAM,WAAW,GAAG,MAAMA,sBAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AAC5D,IAAI,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAACI,8BAAU,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;AAC3D,MAAM,cAAc,EAAE,IAAI;AAC1B,MAAM,SAAS,EAAE,YAAY;AAC7B,KAAK,EAAE;AACP,MAAM,OAAO,EAAE;AACf,QAAQ,OAAO,CAAC,IAAI,EAAE;AACtB,UAAU,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,EAAE;AAC/C,YAAY,OAAO,QAAQ,CAAC;AAC5B,WAAW;AACX,UAAU,MAAM,IAAI,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;AACvD,UAAU,IAAI,CAAC,IAAI,EAAE;AACrB,YAAY,MAAM,IAAI,KAAK,CAAC,CAAC,iCAAiC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AACxE,WAAW;AACX,UAAU,OAAO,IAAI,CAAC,OAAO,CAAC;AAC9B,SAAS;AACT,QAAQ,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE;AACjC,UAAU,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,EAAE;AAC/C,YAAY,OAAO,QAAQ,CAAC;AAC5B,WAAW;AACX,UAAU,MAAM,OAAO,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;AAC1D,UAAU,IAAI,CAAC,OAAO,EAAE;AACxB,YAAY,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AAC1C,cAAc,MAAM,IAAI,KAAK,CAAC,CAAC,iCAAiC,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;AAC1E,aAAa;AACb,YAAY,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;AAC9B,WAAW;AACX,UAAU,OAAO,CAAC,CAAC,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;AACvC,SAAS;AACT,OAAO;AACP,KAAK,CAAC,CAAC,CAAC;AACR,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC;AACpB,GAAG;AACH,EAAE,UAAU,CAAC,OAAO,CAAC,oCAAoC,CAAC,CAAC,CAAC;AAC5D,EAAE,KAAK,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAC;AAC/B,EAAE,MAAM,QAAQ,CAAC;AACjB,IAAI,MAAM;AACV,IAAI,eAAe;AACnB,IAAI,iBAAiB;AACrB,IAAI,YAAY;AAChB,IAAI,uBAAuB;AAC3B,IAAI,GAAG,aAAa;AACpB,GAAG,CAAC,CAAC;AACL,EAAE,KAAK,CAAC,mCAAmC,CAAC,CAAC;AAC7C,EAAE,MAAM,cAAc,CAAC,YAAY,CAAC,CAAC;AACrC,EAAE,KAAK,CAAC,mCAAmC,CAAC,CAAC;AAC7C,EAAE,MAAM,QAAQ,CAAC,CAAC,MAAM,EAAE,SAAS,EAAE,cAAc,EAAE,mBAAmB,CAAC,EAAE;AAC3E,IAAI,GAAG,EAAE,YAAY;AACrB,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,YAAY,CAAC;AACtB,CAAC;AACD,eAAe,cAAc,CAAC,GAAG,EAAE;AACnC,EAAE,MAAM,MAAM,GAAG,MAAMJ,sBAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,EAAE,MAAM,CAAC,CAAC;AAC5E,EAAE,MAAM,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACzC,EAAE,MAAM,YAAY,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC;AAChF,EAAE,IAAI,CAAC,YAAY,EAAE;AACrB,IAAI,MAAM,IAAI,KAAK,CAAC,CAAC,8BAA8B,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;AAC/D,GAAG;AACH,EAAE,MAAM,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;AAC7C,EAAE,IAAI,CAAC,KAAK,EAAE;AACd,IAAI,MAAM,IAAI,KAAK,CAAC,CAAC,uBAAuB,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;AACxD,GAAG;AACH,EAAE,MAAM,GAAG,aAAa,CAAC,GAAG,KAAK,CAAC;AAClC,EAAE,MAAM,QAAQ,GAAG,KAAK,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;AACvD,EAAE,MAAMA,sBAAE,CAAC,SAAS,CAACC,YAAW,CAAC,GAAG,EAAE,SAAS,CAAC,EAAE,CAAC,WAAW,EAAE,QAAQ,CAAC;AACzE,CAAC,CAAC,CAAC;AACH,CAAC;AACD,eAAe,SAAS,CAAC,OAAO,EAAE,YAAY,EAAE,OAAO,EAAE;AACzD,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACb,EAAE,MAAM,KAAK,GAAG,UAAU,CAAC;AAC3B,IAAI,MAAM;AACV,IAAIA,YAAW,CAAC,YAAY,EAAE,8CAA8C,CAAC;AAC7E,IAAI,gBAAgB;AACpB,GAAG,EAAE;AACL,IAAI,GAAG,EAAE,OAAO;AAChB,GAAG,CAAC,CAAC;AACL,EAAE,IAAI;AACN,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC;AACpB,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,IAAI,KAAK;AACnE,MAAM,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC9C,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,OAAO,CAAC,MAAM,MAAM,CAAC,QAAQ,CAAC,0BAA0B,CAAC,CAAC,CAAC;AACrE,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,KAAK,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,OAAO,CAAC;AAC9D,CAAC,CAAC,CAAC;AACH,IAAI,KAAK,CAAC,0CAA0C,CAAC,CAAC;AACtD,IAAI,MAAM,WAAW,CAAC,KAAK,CAAC,CAAC;AAC7B,IAAI,MAAM,MAAM,GAAGA,YAAW,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;AACjD,IAAI,KAAK,CAAC,+DAA+D,CAAC,CAAC;AAC3E,IAAI,MAAM,yBAAyB,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;AAC1D,IAAI,KAAK,CAAC,0CAA0C,CAAC,CAAC;AACtD,IAAI,MAAM,cAAc,CAAC,MAAM,CAAC,CAAC;AACjC,IAAI,MAAMD,sBAAE,CAAC,SAAS,CAACC,YAAW,CAAC,MAAM,EAAE,QAAQ,CAAC,EAAE,wCAAwC,CAAC,CAAC;AAChG,IAAI,KAAK,CAAC,kBAAkB,CAAC,CAAC;AAC9B,IAAI,KAAK,MAAM,GAAG,IAAI;AACtB,MAAM,SAAS;AACf,MAAM,UAAU;AAChB,MAAM,OAAO;AACb,MAAM,UAAU;AAChB,MAAM,gBAAgB;AACtB,MAAM,UAAU;AAChB,KAAK,EAAE;AACP,MAAM,KAAK,CAAC,CAAC,cAAc,EAAE,GAAG,CAAC,sBAAsB,CAAC,CAAC,CAAC;AAC1D,MAAM,MAAM,QAAQ,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,MAAM,EAAE,CAAC,CAAC;AACrD,KAAK;AACL,IAAI,KAAK,CAAC,CAAC,+CAA+C,CAAC,CAAC,CAAC;AAC7D,IAAI,MAAM,QAAQ,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,EAAE;AAC5C,MAAM,GAAG,EAAEA,YAAW,CAAC,MAAM,EAAE,UAAU,EAAE,KAAK,CAAC;AACjD,MAAM,GAAG,EAAE;AACX,QAAQ,GAAG,OAAO,CAAC,GAAG;AACtB,QAAQ,sBAAsB,EAAE,yBAAyB;AACzD,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG,SAAS;AACZ,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;AACjB,GAAG;AACH,CAAC;AACD,eAAe,yBAAyB,CAAC,MAAM,EAAE,YAAY,EAAE;AAC/D,EAAE,MAAM,WAAW,GAAGA,YAAW,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;AAC1D,EAAE,MAAM,OAAO,GAAG,MAAMD,sBAAE,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;AACjD,EAAE,OAAO,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC;AAClD,EAAE,OAAO,CAAC,YAAY,GAAG,OAAO,CAAC,YAAY,IAAI,EAAE,CAAC;AACpD,EAAE,KAAK,MAAM,GAAG,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,EAAE;AAC7C,IAAI,MAAM,YAAY,GAAG,MAAMA,sBAAE,CAAC,OAAO,CAACC,YAAW,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC,CAAC;AAC1E,IAAI,KAAK,MAAM,MAAM,IAAI,YAAY,EAAE;AACvC,MAAM,MAAM,OAAO,GAAGI,SAAQ,CAAC,IAAI,EAAE,WAAW,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC;AAC/D,MAAM,MAAM,EAAE,IAAI,EAAE,GAAG,MAAML,sBAAE,CAAC,QAAQ,CAACC,YAAW,CAAC,YAAY,EAAE,GAAG,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC,CAAC;AACjG,MAAM,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;AACrD,MAAM,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;AACpD,MAAM,OAAO,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;AAC3C,KAAK;AACL,GAAG;AACH,EAAED,sBAAE,CAAC,SAAS,CAAC,WAAW,EAAE,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;AACpD,CAAC;AACD,eAAe,YAAY,CAAC,UAAU,EAAE,MAAM,EAAE,OAAO,GAAG,EAAE,EAAE;AAC9D,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACb,EAAE,MAAM,KAAK,GAAG,UAAU,CAAC,CAAC,MAAM,EAAE,eAAe,EAAE,GAAG,OAAO,CAAC,EAAE;AAClE,IAAI,GAAG,EAAE,MAAM;AACf,GAAG,CAAC,CAAC;AACL,EAAE,IAAI;AACN,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC;AACpB,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,IAAI,KAAK;AACnE,MAAM,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC9C,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,OAAO,CAAC,MAAM,MAAM,CAAC,QAAQ,CAAC,4BAA4B,CAAC,CAAC,CAAC;AACvE,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,KAAK,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,UAAU,CAAC;AACjE,CAAC,CAAC,CAAC;AACH,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;AACzD,IAAI,MAAM,WAAW,CAAC,KAAK,CAAC,CAAC;AAC7B,IAAI,MAAM,aAAa,GAAG,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,UAAU,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC;AAC/F,IAAI,MAAM,SAAS,GAAGC,YAAW,CAAC,MAAM,EAAE,SAAS,EAAE,aAAa,CAAC,CAAC;AACpE,IAAI,KAAK,MAAM,GAAG,IAAI,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC,EAAE;AACnE,MAAM,KAAK,CAAC,CAAC,cAAc,EAAE,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,yBAAyB,CAAC,CAAC,CAAC;AACvE,MAAM,MAAM,QAAQ,CAAC,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,SAAS,EAAE,CAAC,CAAC;AAC3D,KAAK;AACL,IAAI,OAAO,aAAa,CAAC;AACzB,GAAG,SAAS;AACZ,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;AACjB,GAAG;AACH,CAAC;AACD,eAAe,YAAY,CAAC,UAAU,EAAE,MAAM,EAAE;AAChD,EAAE,MAAM,QAAQ,GAAG,UAAU,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE;AACjD,IAAI,GAAG,EAAE,MAAM;AACf,IAAI,GAAG,EAAE;AACT,MAAM,GAAG,OAAO,CAAC,GAAG;AACpB,MAAM,YAAY,EAAE,KAAK;AACzB,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,UAAU,GAAG,KAAK,CAAC;AACzB,EAAE,IAAI,OAAO,CAAC;AACd,EAAE,IAAI;AACN,IAAI,KAAK,IAAI,QAAQ,GAAG,CAAC,IAAI,QAAQ,EAAE,EAAE;AACzC,MAAM,IAAI;AACV,QAAQ,OAAO,GAAG,MAAMK,6BAAS,CAAC,MAAM,EAAE,CAAC;AAC3C,QAAQ,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,OAAO,EAAE,CAAC;AAC7C,QAAQ,MAAM,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE,EAAE,SAAS,EAAE,cAAc,EAAE,CAAC,CAAC;AAChF,QAAQ,MAAM,mBAAmB,CAAC,IAAI,EAAE,GAAG,EAAE,oBAAoB,CAAC,CAAC;AACnE,QAAQ,MAAM,mBAAmB,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,EAAE,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;AACvF,QAAQ,KAAK,CAAC,sCAAsC,CAAC,CAAC;AACtD,QAAQ,UAAU,GAAG,IAAI,CAAC;AAC1B,QAAQ,MAAM;AACd,OAAO,CAAC,OAAO,KAAK,EAAE;AACtB,QAAQ,IAAI,QAAQ,IAAI,EAAE,EAAE;AAC5B,UAAU,MAAM,IAAI,KAAK,CAAC,CAAC,uBAAuB,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;AAC7D,SAAS;AACT,QAAQ,KAAK,CAAC,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;AAC1D,QAAQ,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;AACjE,OAAO;AACP,KAAK;AACL,GAAG,SAAS;AACZ,IAAI,MAAM,IAAI,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,KAAK;AACpC,MAAMC,4BAAQ,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,GAAG,KAAK,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC,CAAC;AAC9D,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,IAAI;AACN,IAAI,MAAM,WAAW,CAAC,QAAQ,CAAC,CAAC;AAChC,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,IAAI,CAAC,UAAU,EAAE;AACrB,MAAM,MAAM,KAAK,CAAC;AAClB,KAAK;AACL,GAAG;AACH,CAAC;AACD,eAAe,MAAM,CAAC,QAAQ,EAAE;AAChC,EAAE,MAAM,MAAM,GAAG;AACjB,IAAI,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa;AACnC,IAAI,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa;AACnC,IAAI,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa;AACnC,IAAI,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,iBAAiB;AAC3C,GAAG,CAAC;AACJ,EAAE,IAAI;AACN,IAAI,MAAMC,2BAAO,CAAC,MAAM,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;AAC3C,GAAG,CAAC,OAAO,CAAC,EAAE;AACd,GAAG;AACH,CAAC;AACD,eAAe,gBAAgB,GAAG;AAClC,EAAE,KAAK,CAAC,kBAAkB,CAAC,CAAC;AAC5B,EAAE,MAAM,OAAO,CAAC,GAAG,CAAC;AACpB,IAAI,SAAS;AACb,IAAI,YAAY;AAChB,IAAI,MAAM;AACV,IAAI,UAAU;AACd,IAAI,OAAO;AACX,IAAI,UAAU;AACd,IAAI,QAAQ;AACZ,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACvD,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;AACvB,CAAC;AACD,eAAe,gBAAgB,CAAC,MAAM,EAAE,GAAG,IAAI,EAAE;AACjD,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACb,EAAE,MAAM,KAAK,GAAG,UAAU,CAAC,CAAC,MAAM,EAAE,WAAW,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,EAAE;AAC/E,IAAI,GAAG,EAAE,MAAM;AACf,IAAI,GAAG,EAAE;AACT,MAAM,GAAG,OAAO,CAAC,GAAG;AACpB,MAAM,YAAY,EAAE,KAAK;AACzB,KAAK;AACL,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,MAAM,GAAG,EAAE,CAAC;AAClB,EAAE,IAAI,MAAM,GAAG,EAAE,CAAC;AAClB,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,IAAI,KAAK;AACjE,IAAI,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC5C,GAAG,CAAC,CAAC;AACL,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,IAAI,KAAK;AACjE,IAAI,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC5C,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,UAAU,GAAG,KAAK,CAAC;AACzB,EAAE,MAAM,iBAAiB,GAAG,CAAC,KAAK,KAAK;AACvC,IAAI,MAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACpD,IAAI,OAAO,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,kCAAkC,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,2CAA2C,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,4EAA4E,CAAC,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;AACtP,GAAG,CAAC;AACJ,EAAE,IAAI;AACN,IAAI,MAAM,OAAO,CAAC,MAAM,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,iBAAiB,CAAC,MAAM,CAAC,CAAC,CAAC;AACvF,IAAI,IAAI,iBAAiB,CAAC,MAAM,CAAC,EAAE;AACnC,MAAM,KAAK,CAAC,CAAC,iCAAiC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;AAC1D,MAAM,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC;AAC9B,KAAK;AACL,IAAI,KAAK,CAAC,wCAAwC,CAAC,CAAC;AACpD,IAAI,MAAMC,yBAAK,CAAC,4CAA4C,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;AACxF,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;AAC3C,IAAI,UAAU,GAAG,IAAI,CAAC;AACtB,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC;AACd,IAAI,MAAM,IAAI,KAAK,CAAC,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;AAC3D,GAAG,SAAS;AACZ,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;AACxC,IAAI,MAAM,IAAI,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,KAAK;AACpC,MAAMF,4BAAQ,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,GAAG,KAAK,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC,CAAC;AAC3D,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,IAAI;AACN,IAAI,MAAM,WAAW,CAAC,KAAK,CAAC,CAAC;AAC7B,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,IAAI,CAAC,UAAU,EAAE;AACrB,MAAM,MAAM,IAAI,KAAK,CAAC,CAAC,2BAA2B,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;AAC9D,KAAK;AACL,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;AACxD,GAAG;AACH;;ACpVO,SAAS,gBAAgB,CAAC,OAAO,EAAE;AAC1C,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;AAClE;;;;ACEA,eAAe,IAAI,CAAC,IAAI,EAAE;AAC1B,EAAEG,iBAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AAC5C,EAAE,gBAAgB,CAACA,iBAAO,CAAC,CAAC;AAC5B,EAAEA,iBAAO,CAAC,EAAE,CAAC,WAAW,EAAE,MAAM;AAChC,IAAI,OAAO,CAAC,GAAG,EAAE,CAAC;AAClB,IAAI,OAAO,CAAC,GAAG,CAACC,yBAAK,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAED,iBAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACzE,IAAI,OAAO,CAAC,GAAG,EAAE,CAAC;AAClB,IAAIA,iBAAO,CAAC,UAAU,EAAE,CAAC;AACzB,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACpB,GAAG,CAAC,CAAC;AACL,EAAEA,iBAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACtB,CAAC;AACD,OAAO,CAAC,EAAE,CAAC,oBAAoB,EAAE,CAAC,SAAS,KAAK;AAChD,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC;AACb,EAAE,IAAI,SAAS,YAAY,KAAK,KAAK,CAAC,EAAE,GAAG,SAAS,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,SAAS,CAAC,KAAK,KAAK,IAAI,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,wBAAwB,CAAC,CAAC,EAAE;AACpJ,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC,4BAA4B,EAAE,CAAC,EAAE,GAAG,SAAS,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,SAAS,CAAC,KAAK,KAAK,IAAI,GAAG,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;AAC/H,GAAG,MAAM;AACT,IAAI,IAAI,SAAS,YAAY,KAAK,EAAE;AACpC,MAAM,aAAa,CAAC,SAAS,CAAC,CAAC;AAC/B,KAAK,MAAM;AACX,MAAM,aAAa,CAAC,IAAI,KAAK,CAAC,CAAC,oBAAoB,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACpE,KAAK;AACL,GAAG;AACH,CAAC,CAAC,CAAC;AACH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,aAAa,CAAC;;"}